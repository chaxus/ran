<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ran</title>
    <meta name="description" content="Based on web component library, common function library utils, personal article record and so on">
    <meta name="generator" content="VitePress v1.4.0">
    <link rel="preload stylesheet" href="/ran/assets/style.E9dKQyFQ.css" as="style">
    
    <script type="module" src="/ran/assets/app.CfJxT4ml.js"></script>
    <link rel="preload" href="/ran/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/ran/assets/chunks/theme.B08u4faT.js">
    <link rel="modulepreload" href="/ran/assets/chunks/framework.CHSXtLMd.js">
    <link rel="modulepreload" href="/ran/assets/cn_src_article_docPreview.md.BRrDrIEF.lean.js">
    <link rel="icon" href="/ran/favicon.ico">
    <link rel="manifest" href="/ran/manifest.json">
    <meta name="theme-color" content="#646cff">
    <meta name="author" content="81380@163.com">
    <meta name="robots" content="all">
    <meta name="renderer" content="webkit">
    <meta name="google" content="notranslate">
    <meta property="og:title" content="ran">
    <meta property="og:description" content="Based on web component library, common function library utils, personal article record and so on">
    <meta property="og:url" content="https://chaxus.github.io/ran/">
    <meta property="og:image" content="https://chaxus.github.io/ran/home.svg">
    <meta property="og:type" content="article">
    <meta property="article:home" content="https://chaxus.github.io/ran/">
    <meta property="article:ranui" content="https://chaxus.github.io/ran/src/ranui/">
    <meta property="article:ranuts" content="https://chaxus.github.io/ran/src/ranuts/utils/">
    <meta property="article:section" content="https://chaxus.github.io/ran/src/article/designMode.html">
    <meta name="keywords" content="ran,component,components,ui,design,ranui,web-components,javascript,typescript,js">
    <meta httpEquiv="Permissions-Policy" content="interest-cohort=()">
    <script>function initFontSize(){let l=375;const{documentElement:t}=document,w=window.matchMedia("(orientation: portrait)");let s,e=667/375;const h=navigator.userAgent.toLowerCase();/ipad|ipod/.test(h)&&(e=1024/768,l=768);function a(){const i=navigator.userAgent.toLowerCase(),p=/ipad|ipod/.test(i),f=/android/.test(i),g=/iphone/.test(i);if(!p&&!f&&!g){t.style.fontSize="";return}const m=!w.matches;let r=window.screen.width,d=window.screen.height;r<d&&([r,d]=[d,r]);let n=t.clientWidth,c=d;n/c>=e?(n=c*e,t.classList.remove("adjustHeight"),t.classList.add("adjustWidth")):(c=n/e,t.classList.remove("adjustWidth"),t.classList.add("adjustHeight")),window.adjustWidth=n,window.adjustHeight=c;let o=n/l*16;m&&(o/=e),t.style.fontSize=o+"px";const u=window.getComputedStyle(t).fontSize.replace("px","");o!==u&&(t.style.fontSize=o/u*o+"px")}window.addEventListener("resize",function(){clearTimeout(s),s=setTimeout(a,300)},!1),window.addEventListener("pageshow",function(i){i.persisted&&(clearTimeout(s),s=setTimeout(a,300))},!1),window.addEventListener("orientationchange",function(){console.log("\u6539\u53D8\u4E86\u624B\u673A\u65B9\u5411"),a()},!1),a()}initFontSize();</script>
    <script defer src="https://www.googletagmanager.com/gtag/js?id=G-0MPS5WH1C0"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0MPS5WH1C0");</script>
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3bc20bd8070ce614078a36c686209456";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
    <script>window.uploadFile=i=>{const t=document.getElementById(i),e=document.createElement("input");e.setAttribute("type","file"),e.click(),e.onchange=o=>{const{files:c=[]}=e;if(t&&c&&c.length>0){t.setAttribute("src","");const n=c[0],l=URL.createObjectURL(n);t.setAttribute("src",l)}}};</script>
    <script>const registerServiceWorker=async()=>{if("serviceWorker"in window.navigator)try{const e=await navigator.serviceWorker.register("/ran/sw1728703195.js",{scope:"/ran/"});e.installing?console.log("installing Service worker"):e.waiting?console.log("Service worker installed"):e.active&&console.log("Service worker active")}catch(e){console.error("service worker register error:",e)}};registerServiceWorker();</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <script>import("/ran/pagefind/pagefind.js").then(i=>{window.__pagefind__=i,i.init()}).catch(()=>{});</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-270f8e4a><!--[--><!--]--><!--[--><span tabindex="-1" data-v-cae79c10></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-cae79c10> Skip to content </a><!--]--><!----><header class="VPNav" data-v-270f8e4a data-v-44795173><div class="VPNavBar" data-v-44795173 data-v-ff85f401><div class="wrapper" data-v-ff85f401><div class="container" data-v-ff85f401><div class="title" data-v-ff85f401><div class="VPNavBarTitle has-sidebar" data-v-ff85f401 data-v-c5769ebc><a class="title" href="/ran/cn/" data-v-c5769ebc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/ran/home.svg" alt data-v-e0e5e5de><!--]--><span data-v-c5769ebc>ran</span><!--[--><!--]--></a></div></div><div class="content" data-v-ff85f401><div class="content-body" data-v-ff85f401><!--[--><!--]--><div class="blog-search search" data-pagefind-ignore="all" data-v-ff85f401 data-v-fd998d3a><div class="nav-search-btn-wait" data-v-fd998d3a><span data-v-fd998d3a><svg width="14" height="14" viewBox="0 0 20 20" data-v-fd998d3a><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" data-v-fd998d3a></path></svg></span><span class="search-tip" data-v-fd998d3a>Search</span><span class="metaKey" data-v-fd998d3a> K </span></div><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ff85f401 data-v-36265739><span id="main-nav-aria-label" class="visually-hidden" data-v-36265739> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ran/cn/" tabindex="0" data-v-36265739 data-v-dbfe5822><!--[--><span data-v-dbfe5822>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ran/cn/src/ranuts/" tabindex="0" data-v-36265739 data-v-dbfe5822><!--[--><span data-v-dbfe5822>函数</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ran/cn/src/ranui/" tabindex="0" data-v-36265739 data-v-dbfe5822><!--[--><span data-v-dbfe5822>组件</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ran/cn/src/article/designMode.html" tabindex="0" data-v-36265739 data-v-dbfe5822><!--[--><span data-v-dbfe5822>璀璨</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-ff85f401 data-v-2f66930a data-v-30554091><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-30554091><span class="text" data-v-30554091><span class="vpi-languages option-icon" data-v-30554091></span><!----><span class="vpi-chevron-down text-icon" data-v-30554091></span></span></button><div class="menu" data-v-30554091><div class="VPMenu" data-v-30554091 data-v-741d072f><!----><!--[--><!--[--><div class="items" data-v-2f66930a><p class="title" data-v-2f66930a>简体中文</p><!--[--><div class="VPMenuLink" data-v-2f66930a data-v-539cebd5><a class="VPLink link" href="/ran/src/article/docPreview.html" data-v-539cebd5><!--[-->English<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-ff85f401 data-v-ebdf52b9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-ebdf52b9 data-v-d9e1397d data-v-d2bb6b64><span class="check" data-v-d2bb6b64><span class="icon" data-v-d2bb6b64><!--[--><span class="vpi-sun sun" data-v-d9e1397d></span><span class="vpi-moon moon" data-v-d9e1397d></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ff85f401 data-v-f5212745 data-v-4d8e32d0><!--[--><a class="VPSocialLink no-icon" href="https://github.com/chaxus/ran" aria-label="github" target="_blank" rel="noopener" data-v-4d8e32d0 data-v-84781e74><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ff85f401 data-v-5eb5ec11 data-v-30554091><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-30554091><span class="vpi-more-horizontal icon" data-v-30554091></span></button><div class="menu" data-v-30554091><div class="VPMenu" data-v-30554091 data-v-741d072f><!----><!--[--><!--[--><div class="group translations" data-v-5eb5ec11><p class="trans-title" data-v-5eb5ec11>简体中文</p><!--[--><div class="VPMenuLink" data-v-5eb5ec11 data-v-539cebd5><a class="VPLink link" href="/ran/src/article/docPreview.html" data-v-539cebd5><!--[-->English<!--]--></a></div><!--]--></div><div class="group" data-v-5eb5ec11><div class="item appearance" data-v-5eb5ec11><p class="label" data-v-5eb5ec11>Appearance</p><div class="appearance-action" data-v-5eb5ec11><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-5eb5ec11 data-v-d9e1397d data-v-d2bb6b64><span class="check" data-v-d2bb6b64><span class="icon" data-v-d2bb6b64><!--[--><span class="vpi-sun sun" data-v-d9e1397d></span><span class="vpi-moon moon" data-v-d9e1397d></span><!--]--></span></span></button></div></div></div><div class="group" data-v-5eb5ec11><div class="item social-links" data-v-5eb5ec11><div class="VPSocialLinks social-links-list" data-v-5eb5ec11 data-v-4d8e32d0><!--[--><a class="VPSocialLink no-icon" href="https://github.com/chaxus/ran" aria-label="github" target="_blank" rel="noopener" data-v-4d8e32d0 data-v-84781e74><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ff85f401 data-v-9d6e8671><span class="container" data-v-9d6e8671><span class="top" data-v-9d6e8671></span><span class="middle" data-v-9d6e8671></span><span class="bottom" data-v-9d6e8671></span></span></button></div></div></div></div><div class="divider" data-v-ff85f401><div class="divider-line" data-v-ff85f401></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-270f8e4a data-v-39bb13ec><div class="container" data-v-39bb13ec><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-39bb13ec><span class="vpi-align-left menu-icon" data-v-39bb13ec></span><span class="menu-text" data-v-39bb13ec>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-39bb13ec data-v-b940033a><button data-v-b940033a>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-270f8e4a data-v-7ad7cc6f><div class="curtain" data-v-7ad7cc6f></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-7ad7cc6f><span class="visually-hidden" id="sidebar-aria-label" data-v-7ad7cc6f> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8c7bf8d5><section class="VPSidebarItem level-0 has-active" data-v-8c7bf8d5 data-v-7a8301d1><!----><div class="items" data-v-7a8301d1><!--[--><div class="VPSidebarItem level-1 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/designMode.html" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>23 种经典设计模式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/functionalProgramming.html" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>函数式编程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/docPreview.html" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>web 文档预览方案</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/video.html" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>Web 视频加密动态方案</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/visual.html" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>可视化渲染引擎</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" tabindex="0" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/index.html" data-v-7a8301d1><!--[--><h3 class="text" data-v-7a8301d1>排序算法</h3><!--]--></a><!----></div><div class="items" data-v-7a8301d1><!--[--><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/bubble/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>冒泡排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/select/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>选择排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/insert/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>插入排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/shell/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>希尔排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/merge/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>归并排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/quick/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>快速排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/heap/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>堆排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/count/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>计数排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/bucket/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>桶排序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-7a8301d1 data-v-7a8301d1><div class="item" data-v-7a8301d1><div class="indicator" data-v-7a8301d1></div><a class="VPLink link link" href="/ran/cn/src/article/sort/radix/" data-v-7a8301d1><!--[--><p class="text" data-v-7a8301d1>基数排序</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-270f8e4a data-v-75e53c5a><div class="VPDoc has-sidebar has-aside" data-v-75e53c5a data-v-6e3c7a3c><!--[--><!--]--><div class="container" data-v-6e3c7a3c><div class="aside" data-v-6e3c7a3c><div class="aside-curtain" data-v-6e3c7a3c></div><div class="aside-container" data-v-6e3c7a3c><div class="aside-content" data-v-6e3c7a3c><div class="VPDocAside" data-v-6e3c7a3c data-v-4df27cae><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-4df27cae data-v-a6bb1831><div class="content" data-v-a6bb1831><div class="outline-marker" data-v-a6bb1831></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a6bb1831>On this page</div><ul class="VPDocOutlineItem root" data-v-a6bb1831 data-v-11918db9><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-4df27cae></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6e3c7a3c><div class="content-container" data-v-6e3c7a3c><!--[--><!--]--><main class="main" data-v-6e3c7a3c><div style="position:relative;" class="vp-doc _ran_cn_src_article_docPreview" data-v-6e3c7a3c><div data-pagefind-body="true"><h1> 最全的 docx,pptx,xlsx(excel),pdf 文件预览方案总结 </h1><p>最近遇到了文件预览的需求，但一搜索发现，这还不是一个简单的功能。于是又去查询了很多资料，调研了一些方案，也踩了好多坑。最后总结方案如下</p><ol><li>花钱解决 (使用市面上现有的文件预览服务) <ol><li>微软</li><li>google</li><li>阿里云 IMM</li><li>XDOC</li><li>Office Web 365</li><li>wps 开放平台</li></ol></li><li>前端方案 <ol><li>pptx 的预览方案</li><li>pdf 的预览方案</li><li>docx 的预览方案</li><li>xlsx(excel) 的预览方案</li><li>前端预览方案总结</li></ol></li><li>服务端方案 <ol><li>openOffice</li><li>kkFileView</li><li>onlyOffice</li></ol></li></ol><p>如果有其他人也遇到了同样的问题，有了这篇文章，希望能更方便的解决。</p><p>基本涵盖了所有解决方案。因此，标题写上 <strong>最全</strong> 的文件预览方案调研总结，应该不为过吧。</p><h2 id="一-市面上现有的文件预览服务" tabindex="-1">一：市面上现有的文件预览服务 <a class="header-anchor" href="#一-市面上现有的文件预览服务" aria-label="Permalink to &quot;一：市面上现有的文件预览服务&quot;">​</a></h2><h3 id="_1-微软" tabindex="-1">1.微软 <a class="header-anchor" href="#_1-微软" aria-label="Permalink to &quot;1.微软&quot;">​</a></h3><p><code>docx</code>,<code>pptx</code>,<code>xlsx</code>可以说是<code>office</code>三件套，那自然得看一下 <strong>微软官方</strong> 提供的文件预览服务。使用方法特别简单，只需要将文件链接，拼接到参数后面即可。</p><p>记得<code>encodeURL</code></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">https</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(url)}</span></span></code></pre></div><h4 id="_1-pptx-预览效果" tabindex="-1">(1).PPTX 预览效果： <a class="header-anchor" href="#_1-pptx-预览效果" aria-label="Permalink to &quot;(1).PPTX 预览效果：&quot;">​</a></h4><p><img src="/ran/assets/ms_ppt.C2zYd_IC.webp" alt="image.png"></p><ul><li>优点：还原度很高，功能很丰富，可以选择翻页，甚至支持点击播放动画。</li><li>缺点：不知道是不是墙的原因，加载稍慢。</li></ul><h4 id="_2-excel-预览效果" tabindex="-1">(2).Excel 预览效果： <a class="header-anchor" href="#_2-excel-预览效果" aria-label="Permalink to &quot;(2).Excel 预览效果：&quot;">​</a></h4><p><img src="/ran/assets/ms_excel.CJXFi2bf.webp" alt="image.png"></p><h4 id="_3-doxc-预览效果" tabindex="-1">(3).Doxc 预览效果 <a class="header-anchor" href="#_3-doxc-预览效果" aria-label="Permalink to &quot;(3).Doxc 预览效果&quot;">​</a></h4><p><img src="/ran/assets/ms_word.3k-0mjp0.webp" alt="image.png"></p><h4 id="_4-pdf-预览效果" tabindex="-1">(4).PDF 预览效果 <a class="header-anchor" href="#_4-pdf-预览效果" aria-label="Permalink to &quot;(4).PDF 预览效果&quot;">​</a></h4><p>这个我测试没有成功，返回了一个错误，其他人可以试试。</p><p><img src="/ran/assets/ms_file_not.DgOrkG3n.webp" alt="image.png"></p><h4 id="_5-总的来说" tabindex="-1">(5).总的来说 <a class="header-anchor" href="#_5-总的来说" aria-label="Permalink to &quot;(5).总的来说&quot;">​</a></h4><p>对于<code>docx</code>,<code>pptx</code>,<code>xlsx</code>都有较好的支持，<code>pdf</code>不行。</p><p>还有一个坑点是：这个服务是否稳定，有什么限制，是否收费，都查不到一个定论。在<code>office</code>官方网站上甚至找不到介绍这个东西的地方。</p><p>目前只能找到一个<code>Q&amp;A</code>:<a href="https://answers.microsoft.com/en-us/msoffice/forum/all/what-is-the-status-of-viewofficeappslivecom/830fd75c-9b47-43f9-89c9-4303703fd7f6" target="_blank" rel="noreferrer">https://answers.microsoft.com/en-us/msoffice/forum/all/what-is-the-status-of-viewofficeappslivecom/830fd75c-9b47-43f9-89c9-4303703fd7f6</a></p><p>微软官方人员回答表示：</p><p><img src="/ran/assets/ms_answer.Cgv6ylFF.webp" alt="image.png"></p><p>翻译翻译，就是：几乎永久使用，没有收费计划，不会存储预览的文件数据，限制文件<code>10MB</code>，建议用于 <strong>查看互联网上公开的文件</strong>。</p><p>但经过某些用户测试发现：</p><p><img src="/ran/assets/ms_answer_2.D-D9H1v0.webp" alt="image.png"></p><p>使用了微软的文件预览服务，然后删除了文件地址，仍然可访问，但过一段时间会失效。</p><h3 id="_2-google-drive-查看器" tabindex="-1">2.Google Drive 查看器 <a class="header-anchor" href="#_2-google-drive-查看器" aria-label="Permalink to &quot;2.Google Drive 查看器&quot;">​</a></h3><p>接入简单，同 <code>Office Web Viewer</code>，只需要把 <code>src</code> 改为<code>https://drive.google.com/viewer?url=${encodeURIComponent(url)}</code>即可。</p><p>限制<code>25MB</code>,支持以下格式：</p><p><img src="/ran/assets/google_doc_view.BknjnOKw.webp" alt="image.png"></p><p>测试效果，支持<code>docx,pptx,xlsx,pdf</code>预览，但<code>pptx</code>预览的效果不如微软，没有动画效果，样式有小部分会错乱。</p><p><strong>由于某些众所周知的原因，不可用</strong></p><h3 id="_3-阿里云-imm" tabindex="-1">3.阿里云 IMM <a class="header-anchor" href="#_3-阿里云-imm" aria-label="Permalink to &quot;3.阿里云 IMM&quot;">​</a></h3><p>官方文档如下：<a href="https://help.aliyun.com/document_detail/63273.html" target="_blank" rel="noreferrer">https://help.aliyun.com/document_detail/63273.html</a></p><p><img src="/ran/assets/ali_doc.CYo30EHy.webp" alt="image.png"></p><p>付费使用</p><h3 id="_4-xdoc-文档预览" tabindex="-1">4.XDOC 文档预览 <a class="header-anchor" href="#_4-xdoc-文档预览" aria-label="Permalink to &quot;4.XDOC 文档预览&quot;">​</a></h3><p>说了一些大厂的，在介绍一些其他的，<strong>需要自行分辨</strong></p><p>官网地址：<a href="https://view.xdocin.com/view-xdocin-com_6x5f4x.htm" target="_blank" rel="noreferrer">https://view.xdocin.com/view-xdocin-com_6x5f4x.htm</a></p><p><img src="/ran/assets/xdoc.CeowcMPq.webp" alt="image.png"></p><h3 id="_5-office-web-365" tabindex="-1">5.Office Web 365 <a class="header-anchor" href="#_5-office-web-365" aria-label="Permalink to &quot;5.Office Web 365&quot;">​</a></h3><p>需要注意的是，虽然名字很像<code>office</code>，但我们看网页的<code>Copyright</code>可以发现，其实是一个西安的公司，<strong>不是微软</strong>。</p><p>但毕竟也提供了文件预览的服务</p><p>官网地址：<a href="https://www.officeweb365.com/" target="_blank" rel="noreferrer">https://www.officeweb365.com/</a></p><p><img src="/ran/assets/ow365.CXWyYekS.webp" alt="image.png"></p><h3 id="_6-wps-开放平台" tabindex="-1">6.WPS 开放平台 <a class="header-anchor" href="#_6-wps-开放平台" aria-label="Permalink to &quot;6.WPS 开放平台&quot;">​</a></h3><p>官方地址：<a href="https://solution.wps.cn/" target="_blank" rel="noreferrer">https://solution.wps.cn/</a></p><p><img src="/ran/assets/wps_office.DiET-U8x.webp" alt="image.png"></p><p>付费使用，价格如下：</p><p><img src="/ran/assets/wps_office_price.ler9htjh.webp" alt="image.png"></p><h2 id="二-前端处理方案" tabindex="-1">二：前端处理方案 <a class="header-anchor" href="#二-前端处理方案" aria-label="Permalink to &quot;二：前端处理方案&quot;">​</a></h2><h3 id="_1-pptx-的预览方案" tabindex="-1">1.pptx 的预览方案 <a class="header-anchor" href="#_1-pptx-的预览方案" aria-label="Permalink to &quot;1.pptx 的预览方案&quot;">​</a></h3><p>先查一下有没有现成的轮子，目前<code>pptx</code>的开源预览方案能找到的只有这个：<a href="https://github.com/g21589/PPTX2HTML%E3%80%82%E4%BD%86%E5%B7%B2%E7%BB%8F%E5%85%AD%E4%B8%83%E5%B9%B4%E6%B2%A1%E6%9C%89%E6%9B%B4%E6%96%B0%EF%BC%8C%E4%B9%9F%E6%B2%A1%E6%9C%89%E7%BB%B4%E6%8A%A4%EF%BC%8C%E7%AC%94%E8%80%85%E4%BD%BF%E7%94%A8%E7%9A%84%E6%97%B6%E5%80%99%E5%8F%91%E7%8E%B0%E6%9C%89%E5%BE%88%E5%A4%9A%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98%E3%80%82" target="_blank" rel="noreferrer">https://github.com/g21589/PPTX2HTML。但已经六七年没有更新，也没有维护，笔者使用的时候发现有很多兼容性问题。</a></p><p>简单来说就是，没有。对于这种情况，我们可以自行解析，主要步骤如下：</p><ol><li>查询<code>pptx</code>的国际标准</li><li>解析<code>pptx</code>文件</li><li>渲染成<code>html</code>或者<code>canvas</code>进行展示</li></ol><p>我们先去找一下<code>pptx</code>的国际标准，官方地址：<a href="http://officeopenxml.com/" target="_blank" rel="noreferrer">officeopenxml</a></p><p>先解释下什么是<code>officeopenxml</code>:</p><blockquote><p>Office OpenXML，也称为 OpenXML 或 OOXML，是一种基于 XML 的办公文档格式，包括文字处理文档、电子表格、演示文稿以及图表、图表、形状和其他图形材料。该规范由微软开发，并于 2006 年被 ECMA 国际采用为 ECMA-376。第二个版本于 2008 年 12 月发布，第三个版本于 2011 年 6 月发布。该规范已被 ISO 和 IEC 采用为 ISO/IEC 29500。</p></blockquote><blockquote><p>虽然 Microsoft 继续支持较旧的二进制格式 (.doc、.xls 和.ppt)，但 OOXML 现在是所有 Microsoft Office 文档 (.docx、.xlsx 和.pptx) 的默认格式。</p></blockquote><p>由此可见，<code>Office OpenXML</code>由微软开发，目前已经是国际标准。接下来我们看一下<code>pptx</code>里面有哪些内容，具体可以看<code>pptx</code>的官方标准：<a href="http://officeopenxml.com/anatomyofOOXML-pptx.php" target="_blank" rel="noreferrer">officeopenxml-pptx</a></p><blockquote><p>PresentationML 或.pptx 文件是一个<strong>zip 文件</strong>，其中包含许多“部分”（通常是 UTF-8 或 UTF-16 编码）或 XML 文件。该包还可能包含其他媒体文件，例如图像。该结构根据 OOXML 标准 ECMA-376 第 2 部分中概述的开放打包约定进行组织。</p></blockquote><p><img src="/ran/assets/xml.NyzOyhr4.webp" alt="image.png"></p><p>根据国际标准，我们知道，<code>pptx</code>文件本质就是一个<code>zip</code>文件，其中包含许多部分：</p><blockquote><p>部件的数量和类型将根据演示文稿中的内容而有所不同，但始终会有一个 [Content_Types].xml、一个或多个关系（.rels）部件和一个演示文稿部件（演示文稿.xml），它位于 ppt 文件夹中，用于 Microsoft Powerpoint 文件。通常，还将至少有一个幻灯片部件，以及一张母版幻灯片和一张版式幻灯片，从中形成幻灯片。</p></blockquote><p>那么<code>js</code>如何读取<code>zip</code>呢？</p><p>找到一个工具：<a href="https://www.npmjs.com/package/jszip" target="_blank" rel="noreferrer">https://www.npmjs.com/package/jszip</a></p><p>于是我们可以开始尝试解析<code>pptx</code>了。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JSZip </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;jszip&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 加载 pptx 数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JSZip.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pptxData);</span></span></code></pre></div><ul><li>解析<code>[Content_Types].xml</code></li></ul><p>每个<code>pptx</code>必然会有一个 <code>[Content_Types].xml</code>。此文件包含包中部件的所有内容类型的列表。每个部件及其类型都必须列在 <code>[Content_Types].xml</code> 中。通过它里面的内容，可以解析其他的文件数据</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> filesInfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getContentTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zip);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getContentTypes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">zip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JSZip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ContentTypesJson</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readXmlFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zip, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[Content_Types].xml&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> subObj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ContentTypesJson[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Types&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Override&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> slidesLocArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> slideLayoutsLocArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> subObj.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (subObj[i][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ContentType&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;application/vnd.openxmlformats-officedocument.presentationml.slide+xml&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        slidesLocArray.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subObj[i][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;PartName&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">substr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        slideLayoutsLocArray.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subObj[i][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;PartName&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">substr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    slides: slidesLocArray,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    slideLayouts: slideLayoutsLocArray,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>解析演示文稿</li></ul><p>先获取<code>ppt</code>目录下的<code>presentation.xml</code>演示文稿的大小</p><p>由于演示文稿是<code>xml</code>格式，要真正的读取内容需要执行 <code>readXmlFile</code></p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> slideSize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getSlideSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zip);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getSlideSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">zip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JSZip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readXmlFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zip, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ppt/presentation.xml&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sldSzAttrs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;p:presentation&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;p:sldSz&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    width: (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sldSzAttrs[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 96</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 914400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    height: (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sldSzAttrs[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 96</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 914400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>加载主题</li></ul><p>根据 <code>officeopenxml</code>的标准解释</p><blockquote><p>每个包都包含一个关系部件，用于定义其他部件之间的关系以及与包外部资源的关系。这样可以将关系与内容分开，并且可以轻松地更改关系，而无需更改引用目标的源。</p></blockquote><blockquote><p>除了包的关系部分之外，作为一个或多个关系源的每个部件都有自己的关系部分。每个这样的关系部件都可以在部件的_rels 子文件夹中找到，并通过在部件名称后附加“.rels”来命名。</p></blockquote><p>其中主题的相关信息就在<code>ppt/_rels/presentation.xml.rels</code>中</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loadTheme</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">zip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JSZip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> preResContent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readXmlFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zip, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ppt/_rels/presentation.xml.rels&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> relationshipArray</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> preResContent[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Relationships&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Relationship&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> themeURI;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (relationshipArray.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">constructor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Array) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> relationshipArray.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        relationshipArray[i][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        themeURI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> relationshipArray[i][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Target&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    relationshipArray[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    themeURI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> relationshipArray[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;attrs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Target&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (themeURI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    throw</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Can&#39;t open theme file.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readXmlFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(zip, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ppt/&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> themeURI);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>后续<code>ppt</code>里面的其他内容，都可以这么去解析。根据<code>officeopenxml</code>标准，可能包含：</p><table tabindex="0"><thead><tr><th>Part</th><th>Description</th></tr></thead><tbody><tr><td>Comments Authors</td><td>Contains information about each author who has added a comment to the presentation.</td></tr><tr><td>Comments</td><td>Contains comments for a single slide.</td></tr><tr><td>Handout Master</td><td>Contains the look, position, and size of the slides, notes, header and footer text, date, or page number on the presentation&#39;s handout. There can be only one such part.</td></tr><tr><td>Notes Master</td><td>Contains information about the content and formatting of all notes pages. There can be only one such part.</td></tr><tr><td>Notes Slide</td><td>Contains the notes for a single slide.</td></tr><tr><td>Presentation</td><td>Contains the definition of a slide presentation. There must be one and only one such part. See <a href="http://officeopenxml.com/PrPresentation.php" target="_blank" rel="noreferrer">Presentation</a>.</td></tr><tr><td>Presentation Properties</td><td>Contains all of the presentation&#39;s properties. There must be one and only one such part.</td></tr><tr><td>Slide</td><td>Contains the content of a single slide.</td></tr><tr><td>Slide Layout</td><td>Contains the definition for a slide template. It defines the default appearance and positioning of drawing objects on the slide. There must be one or more such parts.</td></tr><tr><td>Slide Master</td><td>Contains the master definition of formatting, text, and objects that appear on each slide in the presentation that is derived from the slide master. There must be one or more such parts.</td></tr><tr><td>Slide Synchronization Data</td><td>Contains properties specifying the current state of a slide that is being synchronized with a version of the slide stored on a central server.</td></tr><tr><td>User-Defined Tags</td><td>Contains a set of user-defined properties for an object in a presentation. There can be zero or more such parts.</td></tr><tr><td>View Properties</td><td>Contains display properties for the presentation.</td></tr></tbody></table><p>等等内容，我们根据标准一点点解析并渲染就好了。</p><p>完整源码：<a href="https://github.com/chaxus/ran/tree/main/packages/ranui" target="_blank" rel="noreferrer">ranui</a></p><p>使用文档：<a href="https://chaxus.github.io/ran/src/ranui/preview/" target="_blank" rel="noreferrer">preview 组件</a></p><h3 id="_2-pdf-的预览方案" tabindex="-1">2.pdf 的预览方案 <a class="header-anchor" href="#_2-pdf-的预览方案" aria-label="Permalink to &quot;2.pdf 的预览方案&quot;">​</a></h3><h4 id="_1-iframe-和-embed" tabindex="-1">(1).iframe 和 embed <a class="header-anchor" href="#_1-iframe-和-embed" aria-label="Permalink to &quot;(1).iframe 和 embed&quot;">​</a></h4><p><code>pdf</code>比较特别，一般的浏览器默认支持预览<code>pdf</code>。因此，我们可以使用浏览器的能力：</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">iframe</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;viewFileUrl&quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>但这样就完全依赖浏览器，对<code>PDF</code>的展示，交互，是否支持全看浏览器的能力，且不同的浏览器展示和交互往往不同，如果需要统一的话，最好还是尝试其他方案。</p><p><code>embed</code>的解析方式也是一样，这里不举例子了</p><h4 id="_2-pdfjs" tabindex="-1">(2)pdfjs <a class="header-anchor" href="#_2-pdfjs" aria-label="Permalink to &quot;(2)pdfjs&quot;">​</a></h4><p>npm: <a href="https://www.npmjs.com/package/pdfjs-dist" target="_blank" rel="noreferrer">https://www.npmjs.com/package/pdfjs-dist</a></p><p>github 地址：<a href="https://github.com/mozilla/pdfjs-dist" target="_blank" rel="noreferrer">https://github.com/mozilla/pdfjs-dist</a></p><p>由<code>mozilla</code>出品，就是我们常见的<code>MDN</code>的老大。</p><p>而且目前 火狐浏览器 使用的 PDF 预览就是采用这个，我们可以用火狐浏览器打开<code>pdf</code>文件，查看浏览器使用的<code>js</code>就能发现</p><p><img src="/ran/assets/firefox_pdf.BWQR-ogn.webp" alt="image.png"></p><p>需要注意的是，最新版<code>pdf.js</code>限制了<code>node</code>版本，需要大于等于<code>18</code></p><p>github 链接：<a href="https://github.com/mozilla/pdf.js/blob/master/package.json" target="_blank" rel="noreferrer">https://github.com/mozilla/pdf.js/blob/master/package.json</a></p><p><img src="/ran/assets/mdn_pdf.DbNmeC8H.webp" alt="image.png"></p><p>如果你项目<code>node</code>版本小于这个情况，可能会无法使用。</p><p>如果遇到这种情况，可以用以前版本，以前的版本没有限制。</p><p>具体使用情况如下：</p><ul><li>完整源码：<a href="https://github.com/chaxus/ran/tree/main/packages/ranui" target="_blank" rel="noreferrer">https://github.com/chaxus/ran/tree/main/packages/ranui</a></li><li>使用文档：<a href="https://chaxus.github.io/ran/src/ranui/preview/" target="_blank" rel="noreferrer">https://chaxus.github.io/ran/src/ranui/preview/</a></li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdfjs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pdfjs-dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdfjsWorker </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pdfjs-dist/build/pdf.work.entry&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Viewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  width</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  height</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  viewBox</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RenderContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  canvasContext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CanvasRenderingContext2D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  transform</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  viewport</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Viewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PDFPageProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pageNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getViewport</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Viewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  render</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RenderContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PDFDocumentProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  numPages</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getPage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PDFPageProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PdfPreview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> pdfDoc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PDFDocumentProxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pageNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  total</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  dom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  pdf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pdf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArrayBuffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pdfDoc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pdf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdf;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.body;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  private</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getPdfPage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">number</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pdfDoc) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pdfDoc.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(number).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">page</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PDFPageProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> viewport</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getViewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> canvas</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;canvas&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dom.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(canvas);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> canvas.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2d&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewport.viewBox;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          canvas.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> width;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          canvas.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> height;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          viewport.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> width;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          viewport.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> height;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          canvas.style.width </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">floor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(viewport.width) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;px&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          canvas.style.height </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">floor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(viewport.height) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;px&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> renderContext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            canvasContext: context,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            viewport: viewport,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            transform: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, viewport.height],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          page.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(renderContext);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data: page });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pdfDoc is undefined&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  pdfPreview</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    window.pdfjsLib.GlobalWorkerOptions.workerSrc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pdfjsWorker;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    window.pdfjsLib.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getDocument</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pdf).promise.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">doc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PDFDocumentProxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pdfDoc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> doc;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> doc.numPages;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.total; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPdfPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  prevPage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPdfPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  nextPage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.total) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.total;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getPdfPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.pageNumber);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createReader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ArrayBuffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> reader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> FileReader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readAsDataURL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onload</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(reader.result);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onerror</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(error);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reader.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onabort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      reject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abort);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> renderPdf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dom</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;undefined&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pdf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createReader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (pdf) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PDF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PdfPreview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pdf, dom);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        PDF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pdfPreview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;renderPdf&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, error);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="_3-docx-的预览方案" tabindex="-1">3.docx 的预览方案 <a class="header-anchor" href="#_3-docx-的预览方案" aria-label="Permalink to &quot;3.docx 的预览方案&quot;">​</a></h3><p>我们可以去查看<code>docx</code>的国际标准，去解析文件格式，渲染成<code>html</code>和<code>canvas</code>，不过比较好的是，已经有人这么做了，还开源了</p><p><code>npm</code>地址：<a href="https://www.npmjs.com/package/docx-preview" target="_blank" rel="noreferrer">https://www.npmjs.com/package/docx-preview</a></p><p>使用方法如下：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { renderAsync } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;docx-preview&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DocxOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  bodyContainer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  styleContainer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HTMLElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  buffer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Blob</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  docxOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Partial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> renderDocx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DocxOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;undefined&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bodyContainer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">styleContainer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">docxOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {} } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> options;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> defaultOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      className: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;docx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ignoreLastRenderedPageBreak: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> configuration</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assign</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({}, defaultOptions, docxOptions);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bodyContainer) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> renderAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buffer, bodyContainer, styleContainer, configuration);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> contain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;div&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(contain);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> renderAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buffer, contain, styleContainer, configuration);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="_4-xlsx-的预览方案" tabindex="-1">4.xlsx 的预览方案 <a class="header-anchor" href="#_4-xlsx-的预览方案" aria-label="Permalink to &quot;4.xlsx 的预览方案&quot;">​</a></h3><p>我们可以使用这个：</p><p><code>npm</code>地址：<a href="https://www.npmjs.com/package/@vue-office/excel" target="_blank" rel="noreferrer">https://www.npmjs.com/package/@vue-office/excel</a></p><p>支持<code>vue2</code>和<code>vue3</code>，也有<code>js</code>的版本</p><p>对于<code>xlsx</code>的预览方案，这个是找到最好用的了。</p><h3 id="_5-前端预览方案总结" tabindex="-1">5.前端预览方案总结 <a class="header-anchor" href="#_5-前端预览方案总结" aria-label="Permalink to &quot;5.前端预览方案总结&quot;">​</a></h3><p>我们对以上找到的优秀的解决方案，进行改进和总结，并封装成一个<code>web components</code>组件：<a href="https://chaxus.github.io/ran/src/ranui/preview/" target="_blank" rel="noreferrer">preview 组件</a></p><p>为什么是<code>web components</code>组件？</p><p>因为它跟框架无关，可以在任何框架中使用，且使用起来跟原生的<code>div</code>标签一样方便。</p><p>并编写使用文档：<a href="https://chaxus.github.io/ran/src/ranui/preview/" target="_blank" rel="noreferrer">preview 组件文档</a>， 文档支持交互体验。</p><p>源码公开，<code>MIT</code>协议。</p><p>目前<code>docx</code>,<code>pdf</code>,<code>xlsx</code>预览基本可以了，都是最好的方案。<code>pptx</code>预览效果不太好，因为需要自行解析。不过<strong>源码完全公开</strong>，需要的可以提<code>issue</code>，<code>pr</code>或者干脆自取或修改，源码地址：<a href="https://github.com/chaxus/ran/tree/main/packages/ranui" target="_blank" rel="noreferrer">https://github.com/chaxus/ran/tree/main/packages/ranui</a></p><h2 id="三-服务端预览方案" tabindex="-1">三：服务端预览方案 <a class="header-anchor" href="#三-服务端预览方案" aria-label="Permalink to &quot;三：服务端预览方案&quot;">​</a></h2><h3 id="_1-openoffice" tabindex="-1">1.openOffice <a class="header-anchor" href="#_1-openoffice" aria-label="Permalink to &quot;1.openOffice&quot;">​</a></h3><p>由于浏览器不能直接打开<code>docx</code>,<code>pptx</code>,<code>xlsx</code>等格式文件，但可以直接打开<code>pdf</code>和图片。因此，我们可以换一个思路，用服务端去转换下文件的格式，转换成浏览器能识别的格式，然后再让浏览器打开，这不就 OK 了吗，甚至不需要前端处理了。</p><p>我们可以借助<code>openOffice</code>的能力，先介绍一下<code>openOffice</code>:</p><blockquote><p><code>Apache OpenOffice</code>是领先的开源办公软件套件，用于文字处理，电子表格，演示文稿，图形，数据库等。它有多种语言版本，适用于所有常用计算机。它以国际开放标准格式存储您的所有数据，还可以从其他常见的办公软件包中读取和写入文件。它可以出于任何目的完全免费下载和使用。</p></blockquote><p>官网如下：<a href="https://www.openoffice.org/" target="_blank" rel="noreferrer">https://www.openoffice.org/</a></p><p>需要先下载<code>opneOffice</code>，找到<code>bin</code>目录，进行设置</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">configuration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOfficeHome</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;这里的路径一般为 C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Program Files (x86)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OpenOffice 4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>测试下转换的文件路径</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] args) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        convertToPDF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/Users/Desktop/asdf.docx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/Users/Desktop/adsf.pdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div><p>完整如下：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">package</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> org.example;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> org.artofsolving.jodconverter.OfficeDocumentConverter;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> org.artofsolving.jodconverter.office.DefaultOfficeManagerConfiguration;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> org.artofsolving.jodconverter.office.OfficeManager;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> java.io.File;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OfficeUtil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OfficeManager officeManager;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> port[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * start openOffice service.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> startService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        DefaultOfficeManagerConfiguration configuration </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefaultOfficeManagerConfiguration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;准备启动 office 转换服务....&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            configuration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOfficeHome</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;这里的路径一般为 C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Program Files (x86)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OpenOffice 4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            configuration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setPortNumbers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(port); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置转换端口，默认为 8100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            configuration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTaskExecutionTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30L</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置任务执行超时为 30 分钟</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            configuration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTaskQueueTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 24L</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置任务队列超时为 24 小时</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            officeManager </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> configuration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">buildOfficeManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            officeManager.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 启动服务</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;office 转换服务启动成功！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Exception </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;office 转换服务启动失败！详细信息：&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * stop openOffice service.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> stopService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;准备关闭 office 转换服务....&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (officeManager </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            officeManager.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;office 转换服务关闭成功！&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convertToPDF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">inputFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">outputFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        startService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;进行文档转换转换：&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> inputFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot; --&gt; &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> outputFile);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        OfficeDocumentConverter converter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OfficeDocumentConverter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(officeManager);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        converter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">convert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(inputFile), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(outputFile));</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        stopService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        convertToPDF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/Users/koolearn/Desktop/asdf.docx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/Users/koolearn/Desktop/adsf.pdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-kkfileview" tabindex="-1">2.kkFileView <a class="header-anchor" href="#_2-kkfileview" aria-label="Permalink to &quot;2.kkFileView&quot;">​</a></h3><p><code>github</code>地址：<a href="https://github.com/kekingcn/kkFileView" target="_blank" rel="noreferrer">https://github.com/kekingcn/kkFileView</a></p><p>支持的文件预览格式非常丰富 <img src="/ran/assets/kkfile_des.CENUMtpY.webp" alt="image.png"></p><p>接下来是 <code>从零到一</code> 的启动步骤，按着步骤来，任何人都能搞定</p><ol><li>安装<code>java</code>:</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span></span></code></pre></div><ol><li>安装<code>maven</code>,<code>java</code>的包管理工具：</li></ol><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mvn</span></span></code></pre></div><ol><li>检查是否安装成功</li></ol><p>执行<code>java --version</code>和<code>mvn -v</code>。我这里遇到<code>mvn</code>找不到<code>java home</code>的报错。解决方式如下：</p><p>我用的是<code>zsh</code>，所以需要去<code>.zshrc</code>添加路径：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>export JAVA_HOME=$(/usr/libexec/java_home)</span></span></code></pre></div><p>添加完后，执行</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>source .zshrc</span></span></code></pre></div><ol start="4"><li>安装下<code>libreoffice </code>:</li></ol><p><code>kkFileView</code>明确要求的额外依赖，否则无法启动</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>brew install libreoffice</span></span></code></pre></div><ol start="5"><li><code>mvn</code>安装依赖</li></ol><p>进入项目，在根目录执行依赖安装，同时清理缓存，跳过单测 (遇到了单测报错的问题)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>mvn clean install -DskipTests</span></span></code></pre></div><ol start="6"><li>启动项目</li></ol><p>找到主文件，主函数<code>mian</code>，点击<code>vscode</code>上面的<code>Run</code>即可执行，路径如下图</p><p><img src="/ran/assets/kkfile.X1tAqvNa.webp" alt="image.png"></p><ol><li>访问页面</li></ol><p>启动完成后，点击终端输出的地址</p><p><img src="/ran/assets/kkfile_output.DD8iZdbo.webp" alt="image.png"></p><ol><li>最终结果</li></ol><p>最终展示如下，可以添加链接进行预览，也可以选择本地文件进行预览</p><p><img src="/ran/assets/kkfile_doc.CPfEUxoD.webp" alt="image.png"></p><p>预览效果非常好</p><h3 id="_3-onlyoffice" tabindex="-1">3.onlyOffice <a class="header-anchor" href="#_3-onlyoffice" aria-label="Permalink to &quot;3.onlyOffice&quot;">​</a></h3><p>官网地址：<a href="https://www.onlyoffice.com/zh" target="_blank" rel="noreferrer">https://www.onlyoffice.com/zh</a></p><p><code>github</code>地址：<a href="https://github.com/ONLYOFFICE" target="_blank" rel="noreferrer">https://github.com/ONLYOFFICE</a></p><p>开发者版本和社区版免费，企业版付费：<a href="https://www.onlyoffice.com/zh/docs-enterprise-prices.aspx" target="_blank" rel="noreferrer">https://www.onlyoffice.com/zh/docs-enterprise-prices.aspx</a></p><p>预览的文件种类没有<code>kkFileView</code>多，但对<code>office</code>三件套有很好的支持，甚至支持多人编辑。</p><h2 id="四-总结" tabindex="-1">四：总结 <a class="header-anchor" href="#四-总结" aria-label="Permalink to &quot;四：总结&quot;">​</a></h2><ol><li>外部服务，推荐微软的<code>view.officeapps.live.com/op/view.aspx</code>，但只建议预览一些互联网公开的文件，不建议使用在要求保密性和稳定性的文件。</li><li>对保密性和稳定性有要求，且不差钱的，可以试试大厂服务，阿里云解决方案。</li><li>服务端技术比较给力的，使用服务端预览方案。目前最好最全的效果是服务端预览方案。</li><li>不想花钱，没有服务器的，使用前端预览方案，客户端渲染零成本。</li></ol><h2 id="五-参考文档" tabindex="-1">五：参考文档： <a class="header-anchor" href="#五-参考文档" aria-label="Permalink to &quot;五：参考文档：&quot;">​</a></h2><ol><li><a href="https://blog.csdn.net/Li_Zhongxin/article/details/132105957" target="_blank" rel="noreferrer">在 java 中如何使用 openOffice 进行格式转换</a></li><li><a href="https://blog.51cto.com/u_15899048/5902747" target="_blank" rel="noreferrer">MAC 搭建 OpenOffice 完整教程 - 保姆级</a></li><li><a href="https://juejin.cn/post/7251199685130059833" target="_blank" rel="noreferrer">纯 js 实现 docx、xlsx、pdf 文件预览库，使用超简单</a></li><li><a href="https://juejin.cn/post/7071598747519549454" target="_blank" rel="noreferrer">前端实现 word、excel、pdf、ppt、mp4、图片、文本等文件的预览</a></li></ol></div></div></main><footer class="VPDocFooter" data-v-6e3c7a3c data-v-8e5d41f8><!--[--><!--]--><div class="edit-info" data-v-8e5d41f8><!----><div class="last-updated" data-v-8e5d41f8><p class="VPLastUpdated" data-v-8e5d41f8 data-v-b6f16cf9>Last updated: <time datetime="2024-10-12T03:12:37.000Z" data-v-b6f16cf9></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-8e5d41f8><span class="visually-hidden" id="doc-footer-aria-label" data-v-8e5d41f8>Pager</span><div class="pager" data-v-8e5d41f8><a class="VPLink link pager-link prev" href="/ran/cn/src/article/functionalProgramming.html" data-v-8e5d41f8><!--[--><span class="desc" data-v-8e5d41f8>Previous page</span><span class="title" data-v-8e5d41f8>函数式编程</span><!--]--></a></div><div class="pager" data-v-8e5d41f8><a class="VPLink link pager-link next" href="/ran/cn/src/article/video.html" data-v-8e5d41f8><!--[--><span class="desc" data-v-8e5d41f8>Next page</span><span class="title" data-v-8e5d41f8>Web 视频加密动态方案</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-270f8e4a data-v-96de3340><div class="container" data-v-96de3340><p class="message" data-v-96de3340>Released under the MIT License.</p><p class="copyright" data-v-96de3340>Copyright © 2022-11-11</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"cn_index.md\":\"0kzgXyFr\",\"cn_src_article_astparse_tokenizer.md\":\"Be5lTQKA\",\"cn_src_article_babel.md\":\"rAspsh5G\",\"cn_src_article_bundle.md\":\"65R3DvSm\",\"cn_src_article_designmode.md\":\"BqNiAb_Y\",\"cn_src_article_docpreview.md\":\"BRrDrIEF\",\"cn_src_article_functionalprogramming.md\":\"QqkRa617\",\"cn_src_article_imagemin.md\":\"BD51FgwZ\",\"cn_src_article_javascript_domload.md\":\"ePyh9ZRf\",\"cn_src_article_sort_bubble_index.md\":\"DhzOSuoL\",\"cn_src_article_sort_bucket_index.md\":\"iKnXhO5A\",\"cn_src_article_sort_count_index.md\":\"Cl7iYY9W\",\"cn_src_article_sort_heap_index.md\":\"mL6leDCa\",\"cn_src_article_sort_index.md\":\"08d3P1kH\",\"cn_src_article_sort_insert_index.md\":\"C6siGqvF\",\"cn_src_article_sort_merge_index.md\":\"DHgqFsQk\",\"cn_src_article_sort_quick_index.md\":\"nZxAppd6\",\"cn_src_article_sort_radix_index.md\":\"WNmlYeAN\",\"cn_src_article_sort_select_index.md\":\"gIQln0jl\",\"cn_src_article_sort_shell_index.md\":\"DBoMnfgs\",\"cn_src_article_systemdesign.md\":\"BS7WrgOy\",\"cn_src_article_typescript_calculate.md\":\"CDNPBSOv\",\"cn_src_article_typescript_index.md\":\"xhcQzYKG\",\"cn_src_article_typescript_pattern.md\":\"Dmc8v8qK\",\"cn_src_article_typescript_reconstruction.md\":\"y0pME8dQ\",\"cn_src_article_typescript_recursion.md\":\"Cbh8DOxI\",\"cn_src_article_typescript_uniontype.md\":\"DSQmi5Tg\",\"cn_src_article_video.md\":\"BHOJcjlO\",\"cn_src_article_visual.md\":\"DqgBm0SZ\",\"cn_src_note_centos.md\":\"Dd37Ex5S\",\"cn_src_note_docker.md\":\"DBlFO17f\",\"cn_src_note_libreoffice2wasm.md\":\"DQRPQED0\",\"cn_src_note_ubuntu.md\":\"OMrqGjGg\",\"cn_src_ranui_button_index.md\":\"BDcjlPmF\",\"cn_src_ranui_checkbox_index.md\":\"BYpHGGn8\",\"cn_src_ranui_icon_index.md\":\"B1V9PRxj\",\"cn_src_ranui_image_index.md\":\"5jpZJsQ-\",\"cn_src_ranui_index.md\":\"O6NeSIto\",\"cn_src_ranui_input_index.md\":\"N5yg7is0\",\"cn_src_ranui_loading_index.md\":\"D4K746FX\",\"cn_src_ranui_math_index.md\":\"CIJlviae\",\"cn_src_ranui_message_index.md\":\"wVjYP45A\",\"cn_src_ranui_modal_index.md\":\"BuDHHn2M\",\"cn_src_ranui_player_index.md\":\"qcI6qb8P\",\"cn_src_ranui_popover_index.md\":\"BYbffMAB\",\"cn_src_ranui_preview_index.md\":\"CyAUjykp\",\"cn_src_ranui_progress_index.md\":\"B5qyrqdM\",\"cn_src_ranui_radar_index.md\":\"CdnZK7Pb\",\"cn_src_ranui_select_index.md\":\"DaJPr9cC\",\"cn_src_ranui_skeleton_index.md\":\"CFMGgnwG\",\"cn_src_ranui_tab_index.md\":\"CY1b1u1V\",\"cn_src_ranui_tabs_index.md\":\"CpWMVttn\",\"cn_src_ranuts_binarytree_index.md\":\"Cv4oga8R\",\"cn_src_ranuts_bundler_index.md\":\"alHSjuA6\",\"cn_src_ranuts_file_appendfile.md\":\"B1djr2WE\",\"cn_src_ranuts_file_fileinfo.md\":\"QR_sWfs6\",\"cn_src_ranuts_file_readdir.md\":\"DFB7FVlj\",\"cn_src_ranuts_file_readfile.md\":\"B89kbS8J\",\"cn_src_ranuts_file_watchfile.md\":\"BAjI-OaD\",\"cn_src_ranuts_file_writefile.md\":\"DWkSsJv9\",\"cn_src_ranuts_index.md\":\"BA8cILpe\",\"cn_src_ranuts_mimetype_mimetype.md\":\"CmQXZWG3\",\"cn_src_ranuts_mode_subscribe.md\":\"NMm6FNO3\",\"cn_src_ranuts_utils_convertimagetobase64.md\":\"CQ_RoAmb\",\"cn_src_ranuts_utils_filterobj.md\":\"BqJRLgq8\",\"cn_src_ranuts_utils_formatjson.md\":\"Bh24FNd_\",\"cn_src_ranuts_utils_getcookie.md\":\"DxXBdlVr\",\"cn_src_ranuts_utils_ocr.md\":\"B4yUe53w\",\"cn_src_ranuts_utils_str2xml.md\":\"BaFKZ-2M\",\"cn_src_ranuts_utils_task.md\":\"CDbscsJ2\",\"cn_src_types_ts类型.md\":\"8-URD2RM\",\"cn_src_types_模式匹配.md\":\"-Hg913qX\",\"cn_src_types_类型运算.md\":\"DPzhEpck\",\"cn_src_types_高级类型.md\":\"BQ0iDGrX\",\"index.md\":\"DJiM3g0O\",\"src_article_astparse_tokenizer.md\":\"CJgdOmtY\",\"src_article_babel.md\":\"CA-cRcF6\",\"src_article_bundle.md\":\"pJHPU684\",\"src_article_designmode.md\":\"CQjOH8Aq\",\"src_article_functionalprogramming.md\":\"Cmp2qFRI\",\"src_article_imagemin.md\":\"C47x7cUg\",\"src_article_javascript_domload.md\":\"E9g_n3_p\",\"src_article_sort_bubble_index.md\":\"Uyukvvj_\",\"src_article_sort_bucket_index.md\":\"qqF6Sj4P\",\"src_article_sort_count_index.md\":\"C7C1FNVH\",\"src_article_sort_heap_index.md\":\"D4Xl3ax4\",\"src_article_sort_index.md\":\"BpYLVrl8\",\"src_article_sort_insert_index.md\":\"DVHTMM7z\",\"src_article_sort_merge_index.md\":\"SwAYr2r5\",\"src_article_sort_quick_index.md\":\"DC_bDmFO\",\"src_article_sort_radix_index.md\":\"DOCQJ1JY\",\"src_article_sort_select_index.md\":\"Be1rqYIJ\",\"src_article_sort_shell_index.md\":\"DKh6PE9d\",\"src_article_typescript_calculate.md\":\"CRWKCA-P\",\"src_article_typescript_index.md\":\"wjDn-lKs\",\"src_article_typescript_pattern.md\":\"Ez6YuvlL\",\"src_article_typescript_reconstruction.md\":\"DExhBwDE\",\"src_article_typescript_recursion.md\":\"DDZSliPb\",\"src_article_typescript_uniontype.md\":\"BQhAt8mB\",\"src_ranui_button_index.md\":\"knupWQOc\",\"src_ranui_checkbox_index.md\":\"CmEyFQLb\",\"src_ranui_icon_index.md\":\"DWZ8pJQu\",\"src_ranui_image_index.md\":\"C76U51KM\",\"src_ranui_index.md\":\"VveRY0aV\",\"src_ranui_input_index.md\":\"BAWJIBJZ\",\"src_ranui_loading_index.md\":\"CxCc5xD8\",\"src_ranui_math_index.md\":\"IY83GwaQ\",\"src_ranui_message_index.md\":\"CBIOZrnU\",\"src_ranui_modal_index.md\":\"humdf-kN\",\"src_ranui_player_index.md\":\"BhELSses\",\"src_ranui_popover_index.md\":\"Bl1nd44O\",\"src_ranui_preview_index.md\":\"BF58Mgx1\",\"src_ranui_progress_index.md\":\"CoMblFHd\",\"src_ranui_radar_index.md\":\"RgzR_NYQ\",\"src_ranui_select_index.md\":\"BKakZMxv\",\"src_ranui_skeleton_index.md\":\"DuejSthu\",\"src_ranui_tab_index.md\":\"DFpJEDjU\",\"src_ranui_tabs_index.md\":\"BP5Dd9UX\",\"src_ranuts_binarytree_index.md\":\"Bo5xKeFC\",\"src_ranuts_bundler_index.md\":\"CsAuaeoq\",\"src_ranuts_file_appendfile.md\":\"DN1hyzGA\",\"src_ranuts_file_fileinfo.md\":\"BTEg4x1A\",\"src_ranuts_file_readdir.md\":\"DfAKb-lm\",\"src_ranuts_file_readfile.md\":\"CdwZqNwc\",\"src_ranuts_file_watchfile.md\":\"2m1MF-uY\",\"src_ranuts_file_writefile.md\":\"BBdQ8aK5\",\"src_ranuts_index.md\":\"CB2Cn65i\",\"src_ranuts_mimetype_mimetype.md\":\"DSadqbmv\",\"src_ranuts_mode_subscribe.md\":\"CHshxehY\",\"src_ranuts_utils_convertimagetobase64.md\":\"B5TUIzAZ\",\"src_ranuts_utils_filterobj.md\":\"Qc3cdyIl\",\"src_ranuts_utils_formatjson.md\":\"Baw5Xjrg\",\"src_ranuts_utils_getcookie.md\":\"BNIeea85\",\"src_ranuts_utils_ocr.md\":\"CTguy2Qx\",\"src_ranuts_utils_str2xml.md\":\"DnO7V1a3\",\"src_ranuts_utils_task.md\":\"BAX7uuWT\",\"src_types_ts类型.md\":\"CNyAaj8V\",\"src_types_模式匹配.md\":\"BM98mia7\",\"src_types_类型运算.md\":\"BFtIIh3X\",\"src_types_高级类型.md\":\"CJMDsdZH\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"ran\",\"description\":\"Based on web component library, common function library utils, personal article record and so on\",\"base\":\"/ran/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/home.svg\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Function\",\"link\":\"/src/ranuts/\"},{\"text\":\"Component\",\"link\":\"/src/ranui/\"},{\"text\":\"Article\",\"link\":\"/src/article/designMode.md\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/chaxus/ran\"}],\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2022-11-11\"},\"sidebar\":{\"/src/ranuts/\":[{\"text\":\"Overview\",\"link\":\"/src/ranuts/\"},{\"text\":\"Universal Function\",\"items\":[{\"text\":\"Filter object\",\"link\":\"/src/ranuts/utils/filterObj.md\"},{\"text\":\"Statistical execution time\",\"link\":\"/src/ranuts/utils/task.md\"},{\"text\":\"String to xml\",\"link\":\"/src/ranuts/utils/str2xml.md\"},{\"text\":\"Image to base64\",\"link\":\"/src/ranuts/utils/convertImageToBase64.md\"},{\"text\":\"OCR text recognition`\",\"link\":\"/src/ranuts/utils/ocr.md\"}]},{\"text\":\"Document\",\"items\":[{\"text\":\"Example Query details about a file\",\"link\":\"/src/ranuts/file/watchFile.md\"},{\"text\":\"Read the name of the file in the directory\",\"link\":\"/src/ranuts/file/readDir.md\"},{\"text\":\"Listen for file changes\",\"link\":\"/src/ranuts/file/watchFile.md\"},{\"text\":\"Read file contents\",\"link\":\"/src/ranuts/file/readFile.md\"},{\"text\":\"Append file content\",\"link\":\"/src/ranuts/file/appendFile.md\"},{\"text\":\"Write to file content\",\"link\":\"/src/ranuts/file/writeFile.md\"}]},{\"text\":\"Design Pattern\",\"items\":[{\"text\":\"Publish-subscribe model\",\"link\":\"/src/ranuts/mode/subscribe.md\"}]},{\"text\":\"mime type\",\"items\":[{\"text\":\"Get mime by file suffix type\",\"link\":\"/src/ranuts/mimeType/mimeType.md\"}]}],\"/src/ranui/\":[{\"text\":\"Overview \",\"link\":\"/src/ranui/\"},{\"text\":\"Common\",\"items\":[{\"text\":\"Button\",\"link\":\"/src/ranui/button/\"},{\"text\":\"Icon\",\"link\":\"/src/ranui/icon/\"},{\"text\":\"Loading\",\"link\":\"/src/ranui/loading/\"}]},{\"text\":\"Data Presentation\",\"items\":[{\"text\":\"Image\",\"link\":\"/src/ranui/image/\"},{\"text\":\"Math\",\"link\":\"/src/ranui/math\"},{\"text\":\"CheckBox\",\"link\":\"/src/ranui/checkbox/\"},{\"text\":\"Tabs\",\"link\":\"/src/ranui/tabs/\"},{\"text\":\"Preview\",\"link\":\"/src/ranui/preview/\"},{\"text\":\"Radar\",\"link\":\"/src/ranui/radar/\"},{\"text\":\"Select\",\"link\":\"/src/ranui/select/\"},{\"text\":\"Player\",\"link\":\"/src/ranui/player/\"},{\"text\":\"Progress\",\"link\":\"/src/ranui/progress/\"},{\"text\":\"Popover\",\"link\":\"/src/ranui/popover/\"}]},{\"text\":\"Data Entry\",\"items\":[{\"text\":\"Input\",\"link\":\"/src/ranui/input/\"}]},{\"text\":\"Feedback\",\"items\":[{\"text\":\"Message\",\"link\":\"/src/ranui/message/\"},{\"text\":\"Skeleton\",\"link\":\"/src/ranui/skeleton/\"}]}],\"/src/article/\":[{\"items\":[{\"text\":\"23 classic design patterns\",\"link\":\"/src/article/designMode.md\"},{\"text\":\"Functional programming\",\"link\":\"/src/article/functionalProgramming.md\"},{\"text\":\"Sorting algorithm\",\"link\":\"/src/article/sort/index.md\",\"items\":[{\"text\":\"bubble sort\",\"link\":\"/src/article/sort/bubble/\"},{\"text\":\"selection sort\",\"link\":\"/src/article/sort/select/\"},{\"text\":\"insertion sort\",\"link\":\"/src/article/sort/insert/\"},{\"text\":\"shell sort\",\"link\":\"/src/article/sort/shell/\"},{\"text\":\"Merge sort\",\"link\":\"/src/article/sort/merge/\"},{\"text\":\"Quick sort\",\"link\":\"/src/article/sort/quick/\"},{\"text\":\"Heap Sort\",\"link\":\"/src/article/sort/heap/\"},{\"text\":\"Counting sort\",\"link\":\"/src/article/sort/count/\"},{\"text\":\"Bucket sort\",\"link\":\"/src/article/sort/bucket/\"},{\"text\":\"Radix sort\",\"link\":\"/src/article/sort/radix/\"}]}]}]}},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\"},\"cn\":{\"label\":\"简体中文\",\"lang\":\"zh-CN\",\"themeConfig\":{\"logo\":\"/home.svg\",\"nav\":[{\"text\":\"首页\",\"link\":\"/cn/\"},{\"text\":\"函数\",\"link\":\"/cn/src/ranuts/\"},{\"text\":\"组件\",\"link\":\"/cn/src/ranui/\"},{\"text\":\"璀璨\",\"link\":\"/cn/src/article/designMode.md\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/chaxus/ran\"}],\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2022-11-11\"},\"sidebar\":{\"/cn/src/ranuts/\":[{\"text\":\"Overview 总览\",\"link\":\"/cn/src/ranuts/\"},{\"text\":\"通用函数\",\"items\":[{\"text\":\"过滤对象\",\"link\":\"/cn/src/ranuts/utils/filterObj.md\"},{\"text\":\"统计执行时间\",\"link\":\"/cn/src/ranuts/utils/task.md\"},{\"text\":\"字符串转 xml\",\"link\":\"/cn/src/ranuts/utils/str2xml.md\"},{\"text\":\"图片转 base64\",\"link\":\"/cn/src/ranuts/utils/convertImageToBase64.md\"},{\"text\":\"OCR 文字识别`\",\"link\":\"/cn/src/ranuts/utils/ocr.md\"}]},{\"text\":\"文件\",\"items\":[{\"text\":\"查询一个文件的详细信息\",\"link\":\"/cn/src/ranuts/file/watchFile.md\"},{\"text\":\"读取目录下的文件名称\",\"link\":\"/cn/src/ranuts/file/readDir.md\"},{\"text\":\"监听文件是否改变\",\"link\":\"/cn/src/ranuts/file/watchFile.md\"},{\"text\":\"读取文件内容\",\"link\":\"/cn/src/ranuts/file/readFile.md\"},{\"text\":\"追加文件内容\",\"link\":\"/cn/src/ranuts/file/appendFile.md\"},{\"text\":\"写入文件内容\",\"link\":\"/cn/src/ranuts/file/writeFile.md\"}]},{\"text\":\"设计模式\",\"items\":[{\"text\":\"发布订阅模式\",\"link\":\"/cn/src/ranuts/mode/subscribe.md\"}]},{\"text\":\"mime type\",\"items\":[{\"text\":\"通过文件后缀获取 mime type\",\"link\":\"/cn/src/ranuts/mimeType/mimeType.md\"}]}],\"/cn/src/ranui/\":[{\"text\":\"Overview 总览\",\"link\":\"/cn/src/ranui/\"},{\"text\":\"通用\",\"items\":[{\"text\":\"Button 按钮\",\"link\":\"/cn/src/ranui/button/\"},{\"text\":\"Icon 图标\",\"link\":\"/cn/src/ranui/icon/\"},{\"text\":\"Loading 加载中\",\"link\":\"/cn/src/ranui/loading/\"}]},{\"text\":\"数据展示\",\"items\":[{\"text\":\"Image 图片\",\"link\":\"/cn/src/ranui/image/\"},{\"text\":\"Math 数学公式\",\"link\":\"/cn/src/ranui/math/\"},{\"text\":\"CheckBox 多选框\",\"link\":\"/cn/src/ranui/checkbox/\"},{\"text\":\"Tabs 标签页\",\"link\":\"/cn/src/ranui/tabs/\"},{\"text\":\"Preview 预览\",\"link\":\"/cn/src/ranui/preview/\"},{\"text\":\"Radar 雷达图\",\"link\":\"/cn/src/ranui/radar/\"},{\"text\":\"Select 选择框\",\"link\":\"/cn/src/ranui/select/\"},{\"text\":\"Player 视频播放器\",\"link\":\"/cn/src/ranui/player/\"},{\"text\":\"Progress 进度条\",\"link\":\"/cn/src/ranui/progress/\"},{\"text\":\"Popover 气泡卡片\",\"link\":\"/cn/src/ranui/popover/\"}]},{\"text\":\"数据录入\",\"items\":[{\"text\":\"Input 输入框\",\"link\":\"/cn/src/ranui/input/\"}]},{\"text\":\"反馈\",\"items\":[{\"text\":\"Message 全局提示\",\"link\":\"/cn/src/ranui/message/\"},{\"text\":\"Skeleton 骨架屏\",\"link\":\"/cn/src/ranui/skeleton/\"}]}],\"/cn/src/article/\":[{\"items\":[{\"text\":\"23 种经典设计模式\",\"link\":\"/cn/src/article/designMode.md\"},{\"text\":\"函数式编程\",\"link\":\"/cn/src/article/functionalProgramming.md\"},{\"text\":\"web 文档预览方案\",\"link\":\"/cn/src/article/docPreview.md\"},{\"text\":\"Web 视频加密动态方案\",\"link\":\"/cn/src/article/video.md\"},{\"text\":\"可视化渲染引擎\",\"link\":\"/cn/src/article/visual.md\"},{\"text\":\"排序算法\",\"link\":\"/cn/src/article/sort/index.md\",\"items\":[{\"text\":\"冒泡排序\",\"link\":\"/cn/src/article/sort/bubble/\"},{\"text\":\"选择排序\",\"link\":\"/cn/src/article/sort/select/\"},{\"text\":\"插入排序\",\"link\":\"/cn/src/article/sort/insert/\"},{\"text\":\"希尔排序\",\"link\":\"/cn/src/article/sort/shell/\"},{\"text\":\"归并排序\",\"link\":\"/cn/src/article/sort/merge/\"},{\"text\":\"快速排序\",\"link\":\"/cn/src/article/sort/quick/\"},{\"text\":\"堆排序\",\"link\":\"/cn/src/article/sort/heap/\"},{\"text\":\"计数排序\",\"link\":\"/cn/src/article/sort/count/\"},{\"text\":\"桶排序\",\"link\":\"/cn/src/article/sort/bucket/\"},{\"text\":\"基数排序\",\"link\":\"/cn/src/article/sort/radix/\"}]}]}]}}}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>