import{J as ye}from"./jszip.min--o3_SgQz.CiS0z4ab.js";import"./commonjs-dynamic-modules-HhqG7SJg.B9lKsKkd.js";var k;(function(s){s.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",s.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",s.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",s.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",s.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",s.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",s.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",s.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",s.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",s.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",s.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",s.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",s.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",s.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",s.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",s.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",s.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties"})(k||(k={}));function Pe(s,e){return e.elements(s).map(t=>({id:e.attr(t,"Id"),type:e.attr(t,"Type"),target:e.attr(t,"Target"),targetMode:e.attr(t,"TargetMode")}))}const ne={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},v={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt"},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"}};function le(s,e=v.Dxa){return s==null||/.+(p[xt]|[%])$/.test(s)?s:`${(parseInt(s)*e.mul).toFixed(2)}${e.unit}`}function Se(s,e=!1){switch(s){case"1":return!0;case"0":return!1;case"on":return!0;case"off":return!1;case"true":return!0;case"false":return!1;default:return e}}function ie(s,e,t){if(s.namespaceURI!=ne.wordml)return!1;switch(s.localName){case"color":e.color=t.attr(s,"val");break;case"sz":e.fontSize=t.lengthAttr(s,"val",v.FontSize);break;default:return!1}return!0}function we(s,e=!1){e&&(s=s.replace(/<[?].*[?]>/,"")),s=Ce(s);const t=new DOMParser().parseFromString(s,"application/xml"),r=Me(t);if(r)throw new Error(r);return t}function Me(s){var e;return(e=s.getElementsByTagName("parsererror")[0])==null?void 0:e.textContent}function Ce(s){return s.charCodeAt(0)===65279?s.substring(1):s}function Ne(s){return new XMLSerializer().serializeToString(s)}class oe{elements(e,t=null){const r=[];for(let a=0,n=e.childNodes.length;a<n;a++){let i=e.childNodes.item(a);i.nodeType==1&&(t==null||i.localName==t)&&r.push(i)}return r}element(e,t){for(let r=0,a=e.childNodes.length;r<a;r++){let n=e.childNodes.item(r);if(n.nodeType==1&&n.localName==t)return n}return null}elementAttr(e,t,r){var a=this.element(e,t);return a?this.attr(a,r):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let r=0,a=e.attributes.length;r<a;r++){let n=e.attributes.item(r);if(n.localName==t)return n.value}return null}intAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a):r}hexAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a,16):r}floatAttr(e,t,r=null){var a=this.attr(e,t);return a?parseFloat(a):r}boolAttr(e,t,r=null){return Se(this.attr(e,t),r)}lengthAttr(e,t,r=v.Dxa){return le(this.attr(e,t),r)}}const l=new oe;class w{constructor(e,t){this._package=e,this.path=t}async load(){this.rels=await this._package.loadRelationships(this.path);const e=await this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild)}save(){this._package.update(this.path,Ne(this._xmlDocument))}parseXml(e){}}const Ae={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function Ee(s,e){return e.elements(s).map(t=>xe(t,e))}function xe(s,e){let t={name:e.attr(s,"name"),embedFontRefs:[]};for(let r of e.elements(s))switch(r.localName){case"family":t.family=e.attr(r,"val");break;case"altName":t.altName=e.attr(r,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":t.embedFontRefs.push(Fe(r,e));break}return t}function Fe(s,e){return{id:e.attr(s,"id"),key:e.attr(s,"fontKey"),type:Ae[s.localName]}}class Be extends w{parseXml(e){this.fonts=Ee(e,this._package.xmlParser)}}function Re(s){return s==null?void 0:s.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function $(s){let e=s.lastIndexOf("/")+1,t=e==0?"":s.substring(0,e),r=e==0?s:s.substring(e);return[t,r]}function I(s,e){try{const t="http://docx/";return new URL(s,t+e).toString().substring(t.length)}catch{return`${e}${s}`}}function A(s,e){return s.reduce((t,r)=>(t[e(r)]=r,t),{})}function Le(s){return new Promise((e,t)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=()=>t(),r.readAsDataURL(s)})}function H(s){return s&&typeof s=="object"&&!Array.isArray(s)}function Te(s){return typeof s=="string"||s instanceof String}function D(s,...e){if(!e.length)return s;const t=e.shift();if(H(s)&&H(t))for(const a in t)if(H(t[a])){var r;const n=(r=s[a])!==null&&r!==void 0?r:s[a]={};D(n,t[a])}else s[a]=t[a];return D(s,...e)}function x(s){return Array.isArray(s)?s:[s]}class j{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new oe}get(e){return this._zip.files[$e(e)]}update(e,t){this._zip.file(e,t)}static async load(e,t){const r=await ye.loadAsync(e);return new j(r,t)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){var r,a;return(a=(r=this.get(e))==null?void 0:r.async(t))!==null&&a!==void 0?a:Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";if(e!=null){const[a,n]=$(e);t=`${a}_rels/${n}.rels`}const r=await this.load(t);return r?Pe(this.parseXmlDocument(r).firstElementChild,this.xmlParser):null}parseXmlDocument(e){return we(e,this.options.trimXmlDeclaration)}}function $e(s){return s.startsWith("/")?s.substr(1):s}class _e extends w{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function T(s,e){return{type:e.attr(s,"val"),color:e.attr(s,"color"),size:e.lengthAttr(s,"sz",v.Border),offset:e.lengthAttr(s,"space",v.Point),frame:e.boolAttr(s,"frame"),shadow:e.boolAttr(s,"shadow")}}function De(s,e){var t={};for(let r of e.elements(s))switch(r.localName){case"left":t.left=T(r,e);break;case"top":t.top=T(r,e);break;case"right":t.right=T(r,e);break;case"bottom":t.bottom=T(r,e);break}return t}var q;(function(s){s.Continuous="continuous",s.NextPage="nextPage",s.NextColumn="nextColumn",s.EvenPage="evenPage",s.OddPage="oddPage"})(q||(q={}));function ce(s,e=l){var t,r,a={};for(let n of e.elements(s))switch(n.localName){case"pgSz":a.pageSize={width:e.lengthAttr(n,"w"),height:e.lengthAttr(n,"h"),orientation:e.attr(n,"orient")};break;case"type":a.type=e.attr(n,"val");break;case"pgMar":a.pageMargins={left:e.lengthAttr(n,"left"),right:e.lengthAttr(n,"right"),top:e.lengthAttr(n,"top"),bottom:e.lengthAttr(n,"bottom"),header:e.lengthAttr(n,"header"),footer:e.lengthAttr(n,"footer"),gutter:e.lengthAttr(n,"gutter")};break;case"cols":a.columns=Oe(n,e);break;case"headerReference":((t=a.headerRefs)!==null&&t!==void 0?t:a.headerRefs=[]).push(J(n,e));break;case"footerReference":((r=a.footerRefs)!==null&&r!==void 0?r:a.footerRefs=[]).push(J(n,e));break;case"titlePg":a.titlePage=e.boolAttr(n,"val",!0);break;case"pgBorders":a.pageBorders=De(n,e);break;case"pgNumType":a.pageNumber=Ie(n,e);break}return a}function Oe(s,e){return{numberOfColumns:e.intAttr(s,"num"),space:e.lengthAttr(s,"space"),separator:e.boolAttr(s,"sep"),equalWidth:e.boolAttr(s,"equalWidth",!0),columns:e.elements(s,"col").map(t=>({width:e.lengthAttr(t,"w"),space:e.lengthAttr(t,"space")}))}}function Ie(s,e){return{chapSep:e.attr(s,"chapSep"),chapStyle:e.attr(s,"chapStyle"),format:e.attr(s,"fmt"),start:e.intAttr(s,"start")}}function J(s,e){return{id:e.attr(s,"id"),type:e.attr(s,"type")}}function He(s,e){return{before:e.lengthAttr(s,"before"),after:e.lengthAttr(s,"after"),line:e.intAttr(s,"line"),lineRule:e.attr(s,"lineRule")}}function W(s,e){let t={};for(let r of e.elements(s))Ve(r,t,e);return t}function Ve(s,e,t){return!!ie(s,e,t)}function ue(s,e){let t={};for(let r of e.elements(s))he(r,t,e);return t}function he(s,e,t){if(s.namespaceURI!=ne.wordml)return!1;if(ie(s,e,t))return!0;switch(s.localName){case"tabs":e.tabs=ze(s,t);break;case"sectPr":e.sectionProps=ce(s,t);break;case"numPr":e.numbering=je(s,t);break;case"spacing":return e.lineSpacing=He(s,t),!1;case"textAlignment":return e.textAlignment=t.attr(s,"val"),!1;case"keepLines":e.keepLines=t.boolAttr(s,"val",!0);break;case"keepNext":e.keepNext=t.boolAttr(s,"val",!0);break;case"pageBreakBefore":e.pageBreakBefore=t.boolAttr(s,"val",!0);break;case"outlineLvl":e.outlineLevel=t.intAttr(s,"val");break;case"pStyle":e.styleName=t.attr(s,"val");break;case"rPr":e.runProps=W(s,t);break;default:return!1}return!0}function ze(s,e){return e.elements(s,"tab").map(t=>({position:e.lengthAttr(t,"pos"),leader:e.attr(t,"leader"),style:e.attr(t,"val")}))}function je(s,e){var t={};for(let r of e.elements(s))switch(r.localName){case"numId":t.id=e.attr(r,"val");break;case"ilvl":t.level=e.intAttr(r,"val");break}return t}function We(s,e){let t={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let r of e.elements(s))switch(r.localName){case"num":t.numberings.push(Xe(r,e));break;case"abstractNum":t.abstractNumberings.push(Ue(r,e));break;case"numPicBullet":t.bulletPictures.push(qe(r,e));break}return t}function Xe(s,e){let t={id:e.attr(s,"numId"),overrides:[]};for(let r of e.elements(s))switch(r.localName){case"abstractNumId":t.abstractId=e.attr(r,"val");break;case"lvlOverride":t.overrides.push(Ge(r,e));break}return t}function Ue(s,e){let t={id:e.attr(s,"abstractNumId"),levels:[]};for(let r of e.elements(s))switch(r.localName){case"name":t.name=e.attr(r,"val");break;case"multiLevelType":t.multiLevelType=e.attr(r,"val");break;case"numStyleLink":t.numberingStyleLink=e.attr(r,"val");break;case"styleLink":t.styleLink=e.attr(r,"val");break;case"lvl":t.levels.push(de(r,e));break}return t}function de(s,e){let t={level:e.intAttr(s,"ilvl")};for(let r of e.elements(s))switch(r.localName){case"start":t.start=e.attr(r,"val");break;case"lvlRestart":t.restart=e.intAttr(r,"val");break;case"numFmt":t.format=e.attr(r,"val");break;case"lvlText":t.text=e.attr(r,"val");break;case"lvlJc":t.justification=e.attr(r,"val");break;case"lvlPicBulletId":t.bulletPictureId=e.attr(r,"val");break;case"pStyle":t.paragraphStyle=e.attr(r,"val");break;case"pPr":t.paragraphProps=ue(r,e);break;case"rPr":t.runProps=W(r,e);break}return t}function Ge(s,e){let t={level:e.intAttr(s,"ilvl")};for(let r of e.elements(s))switch(r.localName){case"startOverride":t.start=e.intAttr(r,"val");break;case"lvl":t.numberingLevel=de(r,e);break}return t}function qe(s,e){var t=e.element(s,"pict"),r=t&&e.element(t,"shape"),a=r&&e.element(r,"imagedata");return a?{id:e.attr(s,"numPicBulletId"),referenceId:e.attr(a,"id"),style:e.attr(r,"style")}:null}class Je extends w{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,We(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class Ze extends w{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}var o;(function(s){s.Document="document",s.Paragraph="paragraph",s.Run="run",s.Break="break",s.NoBreakHyphen="noBreakHyphen",s.Table="table",s.Row="row",s.Cell="cell",s.Hyperlink="hyperlink",s.Drawing="drawing",s.Image="image",s.Text="text",s.Tab="tab",s.Symbol="symbol",s.BookmarkStart="bookmarkStart",s.BookmarkEnd="bookmarkEnd",s.Footer="footer",s.Header="header",s.FootnoteReference="footnoteReference",s.EndnoteReference="endnoteReference",s.Footnote="footnote",s.Endnote="endnote",s.SimpleField="simpleField",s.ComplexField="complexField",s.Instruction="instruction",s.VmlPicture="vmlPicture",s.MmlMath="mmlMath",s.MmlMathParagraph="mmlMathParagraph",s.MmlFraction="mmlFraction",s.MmlFunction="mmlFunction",s.MmlFunctionName="mmlFunctionName",s.MmlNumerator="mmlNumerator",s.MmlDenominator="mmlDenominator",s.MmlRadical="mmlRadical",s.MmlBase="mmlBase",s.MmlDegree="mmlDegree",s.MmlSuperscript="mmlSuperscript",s.MmlSubscript="mmlSubscript",s.MmlPreSubSuper="mmlPreSubSuper",s.MmlSubArgument="mmlSubArgument",s.MmlSuperArgument="mmlSuperArgument",s.MmlNary="mmlNary",s.MmlDelimiter="mmlDelimiter",s.MmlRun="mmlRun",s.MmlEquationArray="mmlEquationArray",s.MmlLimit="mmlLimit",s.MmlLimitLower="mmlLimitLower",s.MmlMatrix="mmlMatrix",s.MmlMatrixRow="mmlMatrixRow",s.MmlBox="mmlBox",s.MmlBar="mmlBar",s.MmlGroupChar="mmlGroupChar",s.VmlElement="vmlElement",s.Inserted="inserted",s.Deleted="deleted",s.DeletedText="deletedText"})(o||(o={}));class X{constructor(){this.children=[],this.cssStyle={}}}class Ye extends X{constructor(){super(...arguments),this.type=o.Header}}class Ke extends X{constructor(){super(...arguments),this.type=o.Footer}}class pe extends w{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class Qe extends pe{createRootElement(){return new Ye}}class et extends pe{createRootElement(){return new Ke}}function tt(s,e){const t={};for(let r of e.elements(s))switch(r.localName){case"Template":t.template=r.textContent;break;case"Pages":t.pages=F(r.textContent);break;case"Words":t.words=F(r.textContent);break;case"Characters":t.characters=F(r.textContent);break;case"Application":t.application=r.textContent;break;case"Lines":t.lines=F(r.textContent);break;case"Paragraphs":t.paragraphs=F(r.textContent);break;case"Company":t.company=r.textContent;break;case"AppVersion":t.appVersion=r.textContent;break}return t}function F(s){if(!(typeof s>"u"))return parseInt(s)}class rt extends w{parseXml(e){this.props=tt(e,this._package.xmlParser)}}function at(s,e){const t={};for(let r of e.elements(s))switch(r.localName){case"title":t.title=r.textContent;break;case"description":t.description=r.textContent;break;case"subject":t.subject=r.textContent;break;case"creator":t.creator=r.textContent;break;case"keywords":t.keywords=r.textContent;break;case"language":t.language=r.textContent;break;case"lastModifiedBy":t.lastModifiedBy=r.textContent;break;case"revision":r.textContent&&(t.revision=parseInt(r.textContent));break}return t}class st extends w{parseXml(e){this.props=at(e,this._package.xmlParser)}}class nt{}function lt(s,e){var t=new nt,r=e.element(s,"themeElements");for(let a of e.elements(r))switch(a.localName){case"clrScheme":t.colorScheme=it(a,e);break;case"fontScheme":t.fontScheme=ot(a,e);break}return t}function it(s,e){var t={name:e.attr(s,"name"),colors:{}};for(let n of e.elements(s)){var r=e.element(n,"srgbClr"),a=e.element(n,"sysClr");r?t.colors[n.localName]=e.attr(r,"val"):a&&(t.colors[n.localName]=e.attr(a,"lastClr"))}return t}function ot(s,e){var t={name:e.attr(s,"name")};for(let r of e.elements(s))switch(r.localName){case"majorFont":t.majorFont=Z(r,e);break;case"minorFont":t.minorFont=Z(r,e);break}return t}function Z(s,e){return{latinTypeface:e.elementAttr(s,"latin","typeface"),eaTypeface:e.elementAttr(s,"ea","typeface"),csTypeface:e.elementAttr(s,"cs","typeface")}}class ct extends w{constructor(e,t){super(e,t)}parseXml(e){this.theme=lt(e,this._package.xmlParser)}}class fe{}class ut extends fe{constructor(){super(...arguments),this.type=o.Footnote}}class ht extends fe{constructor(){super(...arguments),this.type=o.Endnote}}class me extends w{constructor(e,t,r){super(e,t),this._documentParser=r}}class dt extends me{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",ut)}}class pt extends me{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",ht)}}function ft(s,e){var t={};for(let r of e.elements(s))switch(r.localName){case"defaultTabStop":t.defaultTabStop=e.lengthAttr(r,"val");break;case"footnotePr":t.footnoteProps=Y(r,e);break;case"endnotePr":t.endnoteProps=Y(r,e);break;case"autoHyphenation":t.autoHyphenation=e.boolAttr(r,"val");break}return t}function Y(s,e){var t={defaultNoteIds:[]};for(let r of e.elements(s))switch(r.localName){case"numFmt":t.nummeringFormat=e.attr(r,"val");break;case"footnote":case"endnote":t.defaultNoteIds.push(e.attr(r,"id"));break}return t}class mt extends w{constructor(e,t){super(e,t)}parseXml(e){this.settings=ft(e,this._package.xmlParser)}}function bt(s,e){return e.elements(s,"property").map(t=>{const r=t.firstChild;return{formatId:e.attr(t,"fmtid"),name:e.attr(t,"name"),type:r.nodeName,value:r.textContent}})}class gt extends w{parseXml(e){this.props=bt(e,this._package.xmlParser)}}const vt=[{type:k.OfficeDocument,target:"word/document.xml"},{type:k.ExtendedProperties,target:"docProps/app.xml"},{type:k.CoreProperties,target:"docProps/core.xml"},{type:k.CustomProperties,target:"docProps/custom.xml"}];class U{constructor(){this.parts=[],this.partsMap={}}static async load(e,t,r){var a=new U;return a._options=r,a._parser=t,a._package=await j.load(e,r),a.rels=await a._package.loadRelationships(),await Promise.all(vt.map(n=>{var i;const c=(i=a.rels.find(u=>u.type===n.type))!==null&&i!==void 0?i:n;return a.loadRelationshipPart(c.target,c.type)})),a}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){var r;if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let a=null;switch(t){case k.OfficeDocument:this.documentPart=a=new _e(this._package,e,this._parser);break;case k.FontTable:this.fontTablePart=a=new Be(this._package,e);break;case k.Numbering:this.numberingPart=a=new Je(this._package,e,this._parser);break;case k.Styles:this.stylesPart=a=new Ze(this._package,e,this._parser);break;case k.Theme:this.themePart=a=new ct(this._package,e);break;case k.Footnotes:this.footnotesPart=a=new dt(this._package,e,this._parser);break;case k.Endnotes:this.endnotesPart=a=new pt(this._package,e,this._parser);break;case k.Footer:a=new et(this._package,e,this._parser);break;case k.Header:a=new Qe(this._package,e,this._parser);break;case k.CoreProperties:this.corePropsPart=a=new st(this._package,e);break;case k.ExtendedProperties:this.extendedPropsPart=a=new rt(this._package,e);break;case k.CustomProperties:a=new gt(this._package,e);break;case k.Settings:this.settingsPart=a=new mt(this._package,e);break}if(a==null)return Promise.resolve(null);if(this.partsMap[e]=a,this.parts.push(a),await a.load(),((r=a.rels)==null?void 0:r.length)>0){const[n]=$(a.path);await Promise.all(a.rels.map(i=>this.loadRelationshipPart(I(i.target,n),i.type)))}return a}async loadDocumentImage(e,t){const r=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(r)}async loadNumberingImage(e){const t=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}async loadFont(e,t){const r=await this.loadResource(this.fontTablePart,e,"uint8array");return r&&this.blobToURL(new Blob([kt(r,t)]))}blobToURL(e){return e?this._options.useBase64URL?Le(e):URL.createObjectURL(e):null}findPartByRelId(e,t=null){var r,a=((r=t.rels)!==null&&r!==void 0?r:this.rels).find(i=>i.id==e);const n=t?$(t.path)[0]:"";return a?this.partsMap[I(a.target,n)]:null}getPathById(e,t){const r=e.rels.find(n=>n.id==t),[a]=$(e.path);return r?I(r.target,a):null}loadResource(e,t,r){const a=this.getPathById(e,t);return a?this._package.load(a,r):Promise.resolve(null)}}function kt(s,e){const r=e.replace(/{|}|-/g,""),a=new Array(16);for(let n=0;n<16;n++)a[16-n-1]=parseInt(r.substr(n*2,2),16);for(let n=0;n<32;n++)s[n]=s[n]^a[n%16];return s}function yt(s,e){return{type:o.BookmarkStart,id:e.attr(s,"id"),name:e.attr(s,"name"),colFirst:e.intAttr(s,"colFirst"),colLast:e.intAttr(s,"colLast")}}function Pt(s,e){return{type:o.BookmarkEnd,id:e.attr(s,"id")}}class St extends X{constructor(){super(...arguments),this.type=o.VmlElement,this.attrs={}}}function be(s,e){var t=new St;switch(s.localName){case"rect":t.tagName="rect",Object.assign(t.attrs,{width:"100%",height:"100%"});break;case"oval":t.tagName="ellipse",Object.assign(t.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":t.tagName="line";break;case"shape":t.tagName="g";break;case"textbox":t.tagName="foreignObject",Object.assign(t.attrs,{width:"100%",height:"100%"});break;default:return null}for(const r of l.attrs(s))switch(r.localName){case"style":t.cssStyleText=r.value;break;case"fillcolor":t.attrs.fill=r.value;break;case"from":const[a,n]=K(r.value);Object.assign(t.attrs,{x1:a,y1:n});break;case"to":const[i,c]=K(r.value);Object.assign(t.attrs,{x2:i,y2:c});break}for(const r of l.elements(s))switch(r.localName){case"stroke":Object.assign(t.attrs,wt(r));break;case"fill":Object.assign(t.attrs,Mt());break;case"imagedata":t.tagName="image",Object.assign(t.attrs,{width:"100%",height:"100%"}),t.imageHref={id:l.attr(r,"id"),title:l.attr(r,"title")};break;case"txbxContent":t.children.push(...e.parseBodyElements(r));break;default:const a=be(r,e);a&&t.children.push(a);break}return t}function wt(s){var e;return{stroke:l.attr(s,"color"),"stroke-width":(e=l.lengthAttr(s,"weight",v.Emu))!==null&&e!==void 0?e:"1px"}}function Mt(s){return{}}function K(s){return s.split(",")}var _={shd:"inherit",color:"black",borderColor:"black",highlight:"transparent"};const Ct=[],Q={oMath:o.MmlMath,oMathPara:o.MmlMathParagraph,f:o.MmlFraction,func:o.MmlFunction,fName:o.MmlFunctionName,num:o.MmlNumerator,den:o.MmlDenominator,rad:o.MmlRadical,deg:o.MmlDegree,e:o.MmlBase,sSup:o.MmlSuperscript,sSub:o.MmlSubscript,sPre:o.MmlPreSubSuper,sup:o.MmlSuperArgument,sub:o.MmlSubArgument,d:o.MmlDelimiter,nary:o.MmlNary,eqArr:o.MmlEquationArray,lim:o.MmlLimit,limLow:o.MmlLimitLower,m:o.MmlMatrix,mr:o.MmlMatrixRow,box:o.MmlBox,bar:o.MmlBar,groupChr:o.MmlGroupChar};class Nt{constructor(e){this.options={ignoreWidth:!1,debug:!1,...e}}parseNotes(e,t,r){var a=[];for(let n of l.elements(e,t)){const i=new r;i.id=l.attr(n,"id"),i.noteType=l.attr(n,"type"),i.children=this.parseBodyElements(n),a.push(i)}return a}parseDocumentFile(e){var t=l.element(e,"body"),r=l.element(e,"background"),a=l.element(t,"sectPr");return{type:o.Document,children:this.parseBodyElements(t),props:a?ce(a,l):{},cssStyle:r?this.parseBackground(r):{}}}parseBackground(e){var t={},r=g.colorAttr(e,"color");return r&&(t["background-color"]=r),t}parseBodyElements(e){var t=[];for(let r of l.elements(e))switch(r.localName){case"p":t.push(this.parseParagraph(r));break;case"tbl":t.push(this.parseTable(r));break;case"sdt":t.push(...this.parseSdt(r,a=>this.parseBodyElements(a)));break}return t}parseStylesFile(e){var t=[];return g.foreach(e,r=>{switch(r.localName){case"style":t.push(this.parseStyle(r));break;case"docDefaults":t.push(this.parseDefaultStyles(r));break}}),t}parseDefaultStyles(e){var t={id:null,name:null,target:null,basedOn:null,styles:[]};return g.foreach(e,r=>{switch(r.localName){case"rPrDefault":var a=l.element(r,"rPr");a&&t.styles.push({target:"span",values:this.parseDefaultProperties(a,{})});break;case"pPrDefault":var n=l.element(r,"pPr");n&&t.styles.push({target:"p",values:this.parseDefaultProperties(n,{})});break}}),t}parseStyle(e){var t={id:l.attr(e,"styleId"),isDefault:l.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(l.attr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break;case"character":t.target="span";break}return g.foreach(e,r=>{switch(r.localName){case"basedOn":t.basedOn=l.attr(r,"val");break;case"name":t.name=l.attr(r,"val");break;case"link":t.linked=l.attr(r,"val");break;case"next":t.next=l.attr(r,"val");break;case"aliases":t.aliases=l.attr(r,"val").split(",");break;case"pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(r,{})}),t.paragraphProps=ue(r,l);break;case"rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(r,{})}),t.runProps=W(r,l);break;case"tblPr":case"tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(r,{})});break;case"tblStylePr":for(let a of this.parseTableStyle(r))t.styles.push(a);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${r.localName}`)}}),t}parseTableStyle(e){var t=[],r=l.attr(e,"type"),a="",n="";switch(r){case"firstRow":n=".first-row",a="tr.first-row td";break;case"lastRow":n=".last-row",a="tr.last-row td";break;case"firstCol":n=".first-col",a="td.first-col";break;case"lastCol":n=".last-col",a="td.last-col";break;case"band1Vert":n=":not(.no-vband)",a="td.odd-col";break;case"band2Vert":n=":not(.no-vband)",a="td.even-col";break;case"band1Horz":n=":not(.no-hband)",a="tr.odd-row";break;case"band2Horz":n=":not(.no-hband)",a="tr.even-row";break;default:return[]}return g.foreach(e,i=>{switch(i.localName){case"pPr":t.push({target:`${a} p`,mod:n,values:this.parseDefaultProperties(i,{})});break;case"rPr":t.push({target:`${a} span`,mod:n,values:this.parseDefaultProperties(i,{})});break;case"tblPr":case"tcPr":t.push({target:a,mod:n,values:this.parseDefaultProperties(i,{})});break}}),t}parseNumberingFile(e){var t=[],r={},a=[];return g.foreach(e,n=>{switch(n.localName){case"abstractNum":this.parseAbstractNumbering(n,a).forEach(u=>t.push(u));break;case"numPicBullet":a.push(this.parseNumberingPicBullet(n));break;case"num":var i=l.attr(n,"numId"),c=l.elementAttr(n,"abstractNumId","val");r[c]=i;break}}),t.forEach(n=>n.id=r[n.id]),t}parseNumberingPicBullet(e){var t=l.element(e,"pict"),r=t&&l.element(t,"shape"),a=r&&l.element(r,"imagedata");return a?{id:l.intAttr(e,"numPicBulletId"),src:l.attr(a,"id"),style:l.attr(r,"style")}:null}parseAbstractNumbering(e,t){var r=[],a=l.attr(e,"abstractNumId");return g.foreach(e,n=>{switch(n.localName){case"lvl":r.push(this.parseNumberingLevel(a,n,t));break}}),r}parseNumberingLevel(e,t,r){var a={id:e,level:l.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return g.foreach(t,n=>{switch(n.localName){case"start":a.start=l.intAttr(n,"val");break;case"pPr":this.parseDefaultProperties(n,a.pStyle);break;case"rPr":this.parseDefaultProperties(n,a.rStyle);break;case"lvlPicBulletId":var i=l.intAttr(n,"val");a.bullet=r.find(c=>c.id==i);break;case"lvlText":a.levelText=l.attr(n,"val");break;case"pStyle":a.pStyleName=l.attr(n,"val");break;case"numFmt":a.format=l.attr(n,"val");break;case"suff":a.suff=l.attr(n,"val");break}}),a}parseSdt(e,t){const r=l.element(e,"sdtContent");return r?t(r):[]}parseInserted(e,t){var r,a;return{type:o.Inserted,children:(a=(r=t(e))==null?void 0:r.children)!==null&&a!==void 0?a:[]}}parseDeleted(e,t){var r,a;return{type:o.Deleted,children:(a=(r=t(e))==null?void 0:r.children)!==null&&a!==void 0?a:[]}}parseParagraph(e){var t={type:o.Paragraph,children:[]};for(let r of l.elements(e))switch(r.localName){case"pPr":this.parseParagraphProperties(r,t);break;case"r":t.children.push(this.parseRun(r,t));break;case"hyperlink":t.children.push(this.parseHyperlink(r,t));break;case"bookmarkStart":t.children.push(yt(r,l));break;case"bookmarkEnd":t.children.push(Pt(r,l));break;case"oMath":case"oMathPara":t.children.push(this.parseMathElement(r));break;case"sdt":t.children.push(...this.parseSdt(r,a=>this.parseParagraph(a).children));break;case"ins":t.children.push(this.parseInserted(r,a=>this.parseParagraph(a)));break;case"del":t.children.push(this.parseDeleted(r,a=>this.parseParagraph(a)));break}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,r=>{if(he(r,t,l))return!0;switch(r.localName){case"pStyle":t.styleName=l.attr(r,"val");break;case"cnfStyle":t.className=f.classNameOfCnfStyle(r);break;case"framePr":this.parseFrame(r,t);break;case"rPr":break;default:return!1}return!0})}parseFrame(e,t){var r=l.attr(e,"dropCap");r=="drop"&&(t.cssStyle.float="left")}parseHyperlink(e,t){var r={type:o.Hyperlink,parent:t,children:[]},a=l.attr(e,"anchor"),n=l.attr(e,"id");return a&&(r.href="#"+a),n&&(r.id=n),g.foreach(e,i=>{switch(i.localName){case"r":r.children.push(this.parseRun(i,r));break}}),r}parseRun(e,t){var r={type:o.Run,parent:t,children:[]};return g.foreach(e,a=>{switch(a=this.checkAlternateContent(a),a.localName){case"t":r.children.push({type:o.Text,text:a.textContent});break;case"delText":r.children.push({type:o.DeletedText,text:a.textContent});break;case"fldSimple":r.children.push({type:o.SimpleField,instruction:l.attr(a,"instr"),lock:l.boolAttr(a,"lock",!1),dirty:l.boolAttr(a,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:o.Instruction,text:a.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:o.ComplexField,charType:l.attr(a,"fldCharType"),lock:l.boolAttr(a,"lock",!1),dirty:l.boolAttr(a,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:o.NoBreakHyphen});break;case"br":r.children.push({type:o.Break,break:l.attr(a,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:o.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:o.Symbol,font:l.attr(a,"font"),char:l.attr(a,"char")});break;case"tab":r.children.push({type:o.Tab});break;case"footnoteReference":r.children.push({type:o.FootnoteReference,id:l.attr(a,"id")});break;case"endnoteReference":r.children.push({type:o.EndnoteReference,id:l.attr(a,"id")});break;case"drawing":let n=this.parseDrawing(a);n&&(r.children=[n]);break;case"pict":r.children.push(this.parseVmlPicture(a));break;case"rPr":this.parseRunProperties(a,r);break}}),r}parseMathElement(e){const t=`${e.localName}Pr`,r={type:Q[e.localName],children:[]};for(const n of l.elements(e))if(Q[n.localName])r.children.push(this.parseMathElement(n));else if(n.localName=="r"){var a=this.parseRun(n);a.type=o.MmlRun,r.children.push(a)}else n.localName==t&&(r.props=this.parseMathProperies(n));return r}parseMathProperies(e){const t={};for(const r of l.elements(e))switch(r.localName){case"chr":t.char=l.attr(r,"val");break;case"vertJc":t.verticalJustification=l.attr(r,"val");break;case"pos":t.position=l.attr(r,"val");break;case"degHide":t.hideDegree=l.boolAttr(r,"val");break;case"begChr":t.beginChar=l.attr(r,"val");break;case"endChr":t.endChar=l.attr(r,"val");break}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,r=>{switch(r.localName){case"rStyle":t.styleName=l.attr(r,"val");break;case"vertAlign":t.verticalAlign=f.valueOfVertAlign(r,!0);break;default:return!1}return!0})}parseVmlPicture(e){const t={type:o.VmlPicture,children:[]};for(const r of l.elements(e)){const a=be(r,this);a&&t.children.push(a)}return t}checkAlternateContent(e){var t;if(e.localName!="AlternateContent")return e;var r=l.element(e,"Choice");if(r){var a=l.attr(r,"Requires"),n=e.lookupNamespaceURI(a);if(Ct.includes(n))return r.firstElementChild}return(t=l.element(e,"Fallback"))==null?void 0:t.firstElementChild}parseDrawing(e){for(var t of l.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){var t={type:o.Drawing,children:[],cssStyle:{}},r=e.localName=="anchor";let a=null,n=l.boolAttr(e,"simplePos"),i={relative:"page",align:"left",offset:"0"},c={relative:"page",align:"top",offset:"0"};for(var u of l.elements(e))switch(u.localName){case"simplePos":n&&(i.offset=l.lengthAttr(u,"x",v.Emu),c.offset=l.lengthAttr(u,"y",v.Emu));break;case"extent":t.cssStyle.width=l.lengthAttr(u,"cx",v.Emu),t.cssStyle.height=l.lengthAttr(u,"cy",v.Emu);break;case"positionH":case"positionV":if(!n){var h;let P=u.localName=="positionH"?i:c;var d=l.element(u,"align"),b=l.element(u,"posOffset");P.relative=(h=l.attr(u,"relativeFrom"))!==null&&h!==void 0?h:P.relative,d&&(P.align=d.textContent),b&&(P.offset=g.sizeValue(b,v.Emu))}break;case"wrapTopAndBottom":a="wrapTopAndBottom";break;case"wrapNone":a="wrapNone";break;case"graphic":var y=this.parseGraphic(u);y&&t.children.push(y);break}return a=="wrapTopAndBottom"?(t.cssStyle.display="block",i.align&&(t.cssStyle["text-align"]=i.align,t.cssStyle.width="100%")):a=="wrapNone"?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",i.offset&&(t.cssStyle.left=i.offset),c.offset&&(t.cssStyle.top=c.offset)):r&&(i.align=="left"||i.align=="right")&&(t.cssStyle.float=i.align),t}parseGraphic(e){var t=l.element(e,"graphicData");for(let r of l.elements(t))switch(r.localName){case"pic":return this.parsePicture(r)}return null}parsePicture(e){var t={type:o.Image,src:"",cssStyle:{}},r=l.element(e,"blipFill"),a=l.element(r,"blip");t.src=l.attr(a,"embed");var n=l.element(e,"spPr"),i=l.element(n,"xfrm");t.cssStyle.position="relative";for(var c of l.elements(i))switch(c.localName){case"ext":t.cssStyle.width=l.lengthAttr(c,"cx",v.Emu),t.cssStyle.height=l.lengthAttr(c,"cy",v.Emu);break;case"off":t.cssStyle.left=l.lengthAttr(c,"x",v.Emu),t.cssStyle.top=l.lengthAttr(c,"y",v.Emu);break}return t}parseTable(e){var t={type:o.Table,children:[]};return g.foreach(e,r=>{switch(r.localName){case"tr":t.children.push(this.parseTableRow(r));break;case"tblGrid":t.columns=this.parseTableColumns(r);break;case"tblPr":this.parseTableProperties(r,t);break}}),t}parseTableColumns(e){var t=[];return g.foreach(e,r=>{switch(r.localName){case"gridCol":t.push({width:l.lengthAttr(r,"w")});break}}),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,r=>{switch(r.localName){case"tblStyle":t.styleName=l.attr(r,"val");break;case"tblLook":t.className=f.classNameOftblLook(r);break;case"tblpPr":this.parseTablePosition(r,t);break;case"tblStyleColBandSize":t.colBandSize=l.intAttr(r,"val");break;case"tblStyleRowBandSize":t.rowBandSize=l.intAttr(r,"val");break;default:return!1}return!0}),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto";break}}parseTablePosition(e,t){var r=l.lengthAttr(e,"topFromText"),a=l.lengthAttr(e,"bottomFromText"),n=l.lengthAttr(e,"rightFromText"),i=l.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=f.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=f.addSize(t.cssStyle["margin-left"],i),t.cssStyle["margin-right"]=f.addSize(t.cssStyle["margin-right"],n),t.cssStyle["margin-top"]=f.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){var t={type:o.Row,children:[]};return g.foreach(e,r=>{switch(r.localName){case"tc":t.children.push(this.parseTableCell(r));break;case"trPr":this.parseTableRowProperties(r,t);break}}),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,r=>{switch(r.localName){case"cnfStyle":t.className=f.classNameOfCnfStyle(r);break;case"tblHeader":t.isHeader=l.boolAttr(r,"val");break;default:return!1}return!0})}parseTableCell(e){var t={type:o.Cell,children:[]};return g.foreach(e,r=>{switch(r.localName){case"tbl":t.children.push(this.parseTable(r));break;case"p":t.children.push(this.parseParagraph(r));break;case"tcPr":this.parseTableCellProperties(r,t);break}}),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,r=>{var a;switch(r.localName){case"gridSpan":t.span=l.intAttr(r,"val",null);break;case"vMerge":t.verticalMerge=(a=l.attr(r,"val"))!==null&&a!==void 0?a:"continue";break;case"cnfStyle":t.className=f.classNameOfCnfStyle(r);break;default:return!1}return!0})}parseDefaultProperties(e,t=null,r=null,a=null){return t=t||{},g.foreach(e,n=>{if(!(a!=null&&a(n)))switch(n.localName){case"jc":t["text-align"]=f.valueOfJc(n);break;case"textAlignment":t["vertical-align"]=f.valueOfTextAlignment(n);break;case"color":t.color=g.colorAttr(n,"val",null,_.color);break;case"sz":t["font-size"]=t["min-height"]=l.lengthAttr(n,"val",v.FontSize);break;case"shd":t["background-color"]=g.colorAttr(n,"fill",null,_.shd);break;case"highlight":t["background-color"]=g.colorAttr(n,"val",null,_.highlight);break;case"vertAlign":break;case"position":t.verticalAlign=l.lengthAttr(n,"val",v.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":t.width=f.valueOfSize(n,"w");break;case"trHeight":this.parseTrHeight(n,t);break;case"strike":t["text-decoration"]=l.boolAttr(n,"val",!0)?"line-through":"none";break;case"b":t["font-weight"]=l.boolAttr(n,"val",!0)?"bold":"normal";break;case"i":t["font-style"]=l.boolAttr(n,"val",!0)?"italic":"normal";break;case"caps":t["text-transform"]=l.boolAttr(n,"val",!0)?"uppercase":"none";break;case"smallCaps":t["font-variant"]=l.boolAttr(n,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(n,t);break;case"ind":case"tblInd":this.parseIndentation(n,t);break;case"rFonts":this.parseFont(n,t);break;case"tblBorders":this.parseBorderProperties(n,r||t);break;case"tblCellSpacing":t["border-spacing"]=f.valueOfMargin(n),t["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(n,t);break;case"bdr":t.border=f.valueOfBorder(n);break;case"tcBorders":this.parseBorderProperties(n,t);break;case"vanish":l.boolAttr(n,"val",!0)&&(t.display="none");break;case"kern":break;case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(n,r||t);break;case"tblLayout":t["table-layout"]=f.valueOfTblLayout(n);break;case"vAlign":t["vertical-align"]=f.valueOfTextAlignment(n);break;case"spacing":e.localName=="pPr"&&this.parseSpacing(n,t);break;case"wordWrap":l.boolAttr(n,"val")&&(t["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":t.hyphens=l.boolAttr(n,"val",!0)?"none":"auto";break;case"lang":t.$lang=l.attr(n,"val");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${e.localName}.${n.localName}`);break}}),t}parseUnderline(e,t){var r=l.attr(e,"val");if(r!=null){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"words":t["text-decoration"]="underline";break;case"none":t["text-decoration"]="none";break}var a=g.colorAttr(e,"color");a&&(t["text-decoration-color"]=a)}}parseFont(e,t){var r=l.attr(e,"ascii"),a=f.themeValue(e,"asciiTheme"),n=[r,a].filter(i=>i).join(", ");n.length>0&&(t["font-family"]=n)}parseIndentation(e,t){var r=l.lengthAttr(e,"firstLine"),a=l.lengthAttr(e,"hanging"),n=l.lengthAttr(e,"left"),i=l.lengthAttr(e,"start"),c=l.lengthAttr(e,"right"),u=l.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]=`-${a}`),(n||i)&&(t["margin-left"]=n||i),(c||u)&&(t["margin-right"]=c||u)}parseSpacing(e,t){var r=l.lengthAttr(e,"before"),a=l.lengthAttr(e,"after"),n=l.intAttr(e,"line",null),i=l.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),n!==null)switch(i){case"auto":t["line-height"]=`${(n/240).toFixed(2)}`;break;case"atLeast":t["line-height"]=`calc(100% + ${n/20}pt)`;break;default:t["line-height"]=t["min-height"]=`${n/20}pt`;break}}parseMarginProperties(e,t){g.foreach(e,r=>{switch(r.localName){case"left":t["padding-left"]=f.valueOfMargin(r);break;case"right":t["padding-right"]=f.valueOfMargin(r);break;case"top":t["padding-top"]=f.valueOfMargin(r);break;case"bottom":t["padding-bottom"]=f.valueOfMargin(r);break}})}parseTrHeight(e,t){switch(l.attr(e,"hRule")){case"exact":t.height=l.lengthAttr(e,"val");break;case"atLeast":default:t.height=l.lengthAttr(e,"val");break}}parseBorderProperties(e,t){g.foreach(e,r=>{switch(r.localName){case"start":case"left":t["border-left"]=f.valueOfBorder(r);break;case"end":case"right":t["border-right"]=f.valueOfBorder(r);break;case"top":t["border-top"]=f.valueOfBorder(r);break;case"bottom":t["border-bottom"]=f.valueOfBorder(r);break}})}}const At=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class g{static foreach(e,t){for(var r=0;r<e.childNodes.length;r++){let a=e.childNodes[r];a.nodeType==Node.ELEMENT_NODE&&t(a)}}static colorAttr(e,t,r=null,a="black"){var n=l.attr(e,t);if(n)return n=="auto"?a:At.includes(n)?n:`#${n}`;var i=l.attr(e,"themeColor");return i?`var(--docx-${i}-color)`:r}static sizeValue(e,t=v.Dxa){return le(e.textContent,t)}}class f{static themeValue(e,t){var r=l.attr(e,t);return r?`var(--docx-${r}-font)`:null}static valueOfSize(e,t){var r=v.Dxa;switch(l.attr(e,"type")){case"dxa":break;case"pct":r=v.Percent;break;case"auto":return"auto"}return l.lengthAttr(e,t,r)}static valueOfMargin(e){return l.lengthAttr(e,"w")}static valueOfBorder(e){var t=l.attr(e,"val");if(t=="nil")return"none";var r=g.colorAttr(e,"color"),a=l.lengthAttr(e,"sz",v.Border);return`${a} solid ${r=="auto"?_.borderColor:r}`}static valueOfTblLayout(e){var t=l.attr(e,"val");return t=="fixed"?"fixed":"auto"}static classNameOfCnfStyle(e){const t=l.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((a,n)=>t[n]=="1").join(" ")}static valueOfJc(e){var t=l.attr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t}static valueOfVertAlign(e,t=!1){var r=l.attr(e,"val");switch(r){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:r}static valueOfTextAlignment(e){var t=l.attr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t}static addSize(e,t){return e==null?t:t==null?e:`calc(${e} + ${t})`}static classNameOftblLook(e){const t=l.hexAttr(e,"val",0);let r="";return(l.boolAttr(e,"firstRow")||t&32)&&(r+=" first-row"),(l.boolAttr(e,"lastRow")||t&64)&&(r+=" last-row"),(l.boolAttr(e,"firstColumn")||t&128)&&(r+=" first-col"),(l.boolAttr(e,"lastColumn")||t&256)&&(r+=" last-col"),(l.boolAttr(e,"noHBand")||t&512)&&(r+=" no-hband"),(l.boolAttr(e,"noVBand")||t&1024)&&(r+=" no-vband"),r.trim()}}const ee={pos:0,leader:"none",style:"left"},Et=50;function xt(s=document.body){const e=document.createElement("div");e.style.width="100pt",s.appendChild(e);const t=100/e.offsetWidth;return s.removeChild(e),t}function Ft(s,e,t,r=72/96){const a=s.closest("p"),n=s.getBoundingClientRect(),i=a.getBoundingClientRect(),c=getComputedStyle(a),u=(e==null?void 0:e.length)>0?e.map(S=>({pos:te(S.position),leader:S.leader,style:S.style})).sort((S,R)=>S.pos-R.pos):[ee],h=u[u.length-1],d=i.width*r,b=te(t);let y=h.pos+b;if(y<d)for(;y<d&&u.length<Et;y+=b)u.push({...ee,pos:y});const P=parseFloat(c.marginLeft),N=i.left+P,M=(n.left-N)*r,C=u.find(S=>S.style!="clear"&&S.pos>M);if(C==null)return;let O=1;if(C.style=="right"||C.style=="center"){const S=Array.from(a.querySelectorAll(`.${s.className}`)),R=S.indexOf(s)+1,L=document.createRange();L.setStart(s,1),R<S.length?L.setEndBefore(S[R]):L.setEndAfter(a);const ve=C.style=="center"?.5:1,G=L.getBoundingClientRect(),ke=G.left+ve*G.width-(i.left-P);O=C.pos-ke*r}else O=C.pos-M;switch(s.innerHTML="&nbsp;",s.style.textDecoration="inherit",s.style.wordSpacing=`${O.toFixed(0)}pt`,C.leader){case"dot":case"middleDot":s.style.textDecoration="underline",s.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":s.style.textDecoration="underline";break}}function te(s){return parseFloat(s)}const p={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"};class Bt{constructor(e){this.htmlDocument=e,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.tabsTimeout=0,this.tasks=[],this.createElement=V}render(e,t,r=null,a){var n;this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],r=r||t,ae(r),ae(t),B(r,"docxjs library predefined styles"),r.appendChild(this.renderDefaultStyle()),e.themePart&&(B(r,"docxjs document theme values"),this.renderTheme(e.themePart,r)),e.stylesPart!=null&&(this.styleMap=this.processStyles(e.stylesPart.styles),B(r,"docxjs document styles"),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),B(r,"docxjs document numbering styles"),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),e.footnotesPart&&(this.footnoteMap=A(e.footnotesPart.notes,c=>c.id)),e.endnotesPart&&(this.endnoteMap=A(e.endnotesPart.notes,c=>c.id)),e.settingsPart&&(this.defaultTabSize=(n=e.settingsPart.settings)==null?void 0:n.defaultTabStop),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r);var i=this.renderSections(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(i)):z(t,i),this.refreshTabStops()}renderTheme(e,t){var r,a;const n={},i=(r=e.theme)==null?void 0:r.fontScheme;i&&(i.majorFont&&(n["--docx-majorHAnsi-font"]=i.majorFont.latinTypeface),i.minorFont&&(n["--docx-minorHAnsi-font"]=i.minorFont.latinTypeface));const c=(a=e.theme)==null?void 0:a.colorScheme;if(c)for(let[h,d]of Object.entries(c.colors))n[`--docx-${h}-color`]=`#${d}`;const u=this.styleToString(`.${this.className}`,n);t.appendChild(E(u))}renderFontTable(e,t){for(let r of e.fonts)for(let a of r.embedFontRefs)this.tasks.push(this.document.loadFont(a.id,a.key).then(n=>{const i={"font-family":r.name,src:`url(${n})`};(a.type=="bold"||a.type=="boldItalic")&&(i["font-weight"]="bold"),(a.type=="italic"||a.type=="boldItalic")&&(i["font-style"]="italic"),B(t,`docxjs ${r.name} font`);const c=this.styleToString("@font-face",i);t.appendChild(E(c)),this.refreshTabStops()}))}processStyleName(e){return e?`${this.className}_${Re(e)}`:this.className}processStyles(e){const t=A(e.filter(a=>a.id!=null),a=>a.id);for(const a of e.filter(n=>n.basedOn)){var r=t[a.basedOn];if(r){a.paragraphProps=D(a.paragraphProps,r.paragraphProps),a.runProps=D(a.runProps,r.runProps);for(const n of r.styles){const i=a.styles.find(c=>c.target==n.target);i?this.copyStyleProperties(n.values,i.values):a.styles.push({...n,values:{...n.values}})}}else this.options.debug&&console.warn(`Can't find base style ${a.basedOn}`)}for(let a of e)a.cssName=this.processStyleName(a.id);return t}prodessNumberings(e){var t;for(let r of e.filter(a=>a.pStyleName)){const a=this.findStyle(r.pStyleName);(t=a==null?void 0:a.paragraphProps)!=null&&t.numbering&&(a.paragraphProps.numbering.level=r.level)}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,t.type==o.Table?this.processTable(t):this.processElement(t)}processTable(e){for(var t of e.children)for(var r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(e,t,r=null){if(!e)return t;t==null&&(t={}),r==null&&(r=Object.getOwnPropertyNames(e));for(var a of r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}createSection(e,t){var r=this.createElement("section",{className:e});return t&&(t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height)),t.columns&&t.columns.numberOfColumns&&(r.style.columnCount=`${t.columns.numberOfColumns}`,r.style.columnGap=t.columns.space,t.columns.separator&&(r.style.columnRule="1px solid black"))),r}renderSections(e){const t=[];this.processElement(e);const r=this.splitBySection(e.children);let a=null;for(let i=0,c=r.length;i<c;i++){this.currentFootnoteIds=[];const u=r[i],h=u.sectProps||e.props,d=this.createSection(this.className,h);this.renderStyleValues(e.cssStyle,d),this.options.renderHeaders&&this.renderHeaderFooter(h.headerRefs,h,t.length,a!=h,d);var n=this.createElement("article");this.renderElements(u.elements,n),d.appendChild(n),this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,d),this.options.renderEndnotes&&i==c-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,d),this.options.renderFooters&&this.renderHeaderFooter(h.footerRefs,h,t.length,a!=h,d),t.push(d),a=h}return t}renderHeaderFooter(e,t,r,a,n){var i,c;if(e){var u=(i=(c=t.titlePage&&a?e.find(d=>d.type=="first"):null)!==null&&c!==void 0?c:r%2==1?e.find(d=>d.type=="even"):null)!==null&&i!==void 0?i:e.find(d=>d.type=="default"),h=u&&this.document.findPartByRelId(u.id,this.document.documentPart);if(h){this.currentPart=h,this.usedHederFooterParts.includes(h.path)||(this.processElement(h.rootElement),this.usedHederFooterParts.push(h.path));const[d]=this.renderElements([h.rootElement],n);t!=null&&t.pageMargins&&(h.rootElement.type===o.Header?(d.style.marginTop=`calc(${t.pageMargins.header} - ${t.pageMargins.top})`,d.style.minHeight=`calc(${t.pageMargins.top} - ${t.pageMargins.header})`):h.rootElement.type===o.Footer&&(d.style.marginBottom=`calc(${t.pageMargins.footer} - ${t.pageMargins.bottom})`,d.style.minHeight=`calc(${t.pageMargins.bottom} - ${t.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(e){return e.type!=o.Break?!1:e.break=="lastRenderedPageBreak"?!this.options.ignoreLastRenderedPageBreak:e.break=="page"}splitBySection(e){var t,r={sectProps:null,elements:[]},a=[r];for(let b of e){if(b.type==o.Paragraph){const y=this.findStyle(b.styleName);(t=y==null?void 0:y.paragraphProps)!=null&&t.pageBreakBefore&&(r.sectProps=n,r={sectProps:null,elements:[]},a.push(r))}if(r.elements.push(b),b.type==o.Paragraph){const y=b;var n=y.sectionProps,i=-1,c=-1;if(this.options.breakPages&&y.children&&(i=y.children.findIndex(P=>{var N,M;return c=(M=(N=P.children)==null?void 0:N.findIndex(this.isPageBreakElement.bind(this)))!==null&&M!==void 0?M:-1,c!=-1})),(n||i!=-1)&&(r.sectProps=n,r={sectProps:null,elements:[]},a.push(r)),i!=-1){let P=y.children[i],N=c<P.children.length-1;if(i<y.children.length-1||N){var u=b.children,h={...b,children:u.slice(i)};if(b.children=u.slice(0,i),r.elements.push(h),N){let M=P.children,C={...P,children:M.slice(0,c)};b.children.push(C),P.children=M.slice(c)}}}}}let d=null;for(let b=a.length-1;b>=0;b--)a[b].sectProps==null?a[b].sectProps=d:d=a[b].sectProps;return a}renderWrapper(e){return this.createElement("div",{className:`${this.className}-wrapper`},e)}renderDefaultStyle(){var e=this.className,t=`
.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } 
.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }
.${e} { color: black; hyphens: auto; text-underline-position: from-font; }
section.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }
section.${e}>article { margin-bottom: auto; z-index: 1; }
section.${e}>footer { z-index: 1; }
.${e} table { border-collapse: collapse; }
.${e} table td, .${e} table th { vertical-align: top; }
.${e} p { margin: 0pt; min-height: 1em; }
.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }
.${e} a { color: inherit; text-decoration: inherit; }
`;return E(t)}renderNumbering(e,t){var r="",a=[];for(var n of e){var i=`p.${this.numberingClass(n.id,n.level)}`,c="none";if(n.bullet){let u=`--${this.className}-${n.bullet.src}`.toLowerCase();r+=this.styleToString(`${i}:before`,{content:"' '",display:"inline-block",background:`var(${u})`},n.bullet.style),this.tasks.push(this.document.loadNumberingImage(n.bullet.src).then(h=>{var d=`${this.rootSelector} { ${u}: url(${h}) }`;t.appendChild(E(d))}))}else if(n.levelText){let u=this.numberingCounter(n.id,n.level);const h=u+" "+(n.start-1);n.level>0&&(r+=this.styleToString(`p.${this.numberingClass(n.id,n.level-1)}`,{"counter-reset":h})),a.push(h),r+=this.styleToString(`${i}:before`,{content:this.levelTextToContent(n.levelText,n.suff,n.id,this.numFormatToCssValue(n.format)),"counter-increment":u,...n.rStyle})}else c=this.numFormatToCssValue(n.format);r+=this.styleToString(i,{display:"list-item","list-style-position":"inside","list-style-type":c,...n.pStyle})}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),E(r)}renderStyles(e){var t="";const r=this.styleMap,a=A(e.filter(h=>h.isDefault),h=>h.target);for(const h of e){var n=h.styles;if(h.linked){var i=h.linked&&r[h.linked];i?n=n.concat(i.styles):this.options.debug&&console.warn(`Can't find linked style ${h.linked}`)}for(const d of n){var c,u=`${(c=h.target)!==null&&c!==void 0?c:""}.${h.cssName}`;h.target!=d.target&&(u+=` ${d.target}`),a[h.target]==h&&(u=`.${this.className} ${h.target}, `+u),t+=this.styleToString(u,d.values)}}return E(t)}renderNotes(e,t,r){var a=e.map(i=>t[i]).filter(i=>i);if(a.length>0){var n=this.createElement("ol",null,this.renderElements(a));r.appendChild(n)}}renderElement(e){switch(e.type){case o.Paragraph:return this.renderParagraph(e);case o.BookmarkStart:return this.renderBookmarkStart(e);case o.BookmarkEnd:return null;case o.Run:return this.renderRun(e);case o.Table:return this.renderTable(e);case o.Row:return this.renderTableRow(e);case o.Cell:return this.renderTableCell(e);case o.Hyperlink:return this.renderHyperlink(e);case o.Drawing:return this.renderDrawing(e);case o.Image:return this.renderImage(e);case o.Text:return this.renderText(e);case o.Text:return this.renderText(e);case o.DeletedText:return this.renderDeletedText(e);case o.Tab:return this.renderTab(e);case o.Symbol:return this.renderSymbol(e);case o.Break:return this.renderBreak(e);case o.Footer:return this.renderContainer(e,"footer");case o.Header:return this.renderContainer(e,"header");case o.Footnote:case o.Endnote:return this.renderContainer(e,"li");case o.FootnoteReference:return this.renderFootnoteReference(e);case o.EndnoteReference:return this.renderEndnoteReference(e);case o.NoBreakHyphen:return this.createElement("wbr");case o.VmlPicture:return this.renderVmlPicture(e);case o.VmlElement:return this.renderVmlElement(e);case o.MmlMath:return this.renderContainerNS(e,p.mathML,"math",{xmlns:p.mathML});case o.MmlMathParagraph:return this.renderContainer(e,"span");case o.MmlFraction:return this.renderContainerNS(e,p.mathML,"mfrac");case o.MmlBase:return this.renderContainerNS(e,p.mathML,e.parent.type==o.MmlMatrixRow?"mtd":"mrow");case o.MmlNumerator:case o.MmlDenominator:case o.MmlFunction:case o.MmlLimit:case o.MmlBox:return this.renderContainerNS(e,p.mathML,"mrow");case o.MmlGroupChar:return this.renderMmlGroupChar(e);case o.MmlLimitLower:return this.renderContainerNS(e,p.mathML,"munder");case o.MmlMatrix:return this.renderContainerNS(e,p.mathML,"mtable");case o.MmlMatrixRow:return this.renderContainerNS(e,p.mathML,"mtr");case o.MmlRadical:return this.renderMmlRadical(e);case o.MmlSuperscript:return this.renderContainerNS(e,p.mathML,"msup");case o.MmlSubscript:return this.renderContainerNS(e,p.mathML,"msub");case o.MmlDegree:case o.MmlSuperArgument:case o.MmlSubArgument:return this.renderContainerNS(e,p.mathML,"mn");case o.MmlFunctionName:return this.renderContainerNS(e,p.mathML,"ms");case o.MmlDelimiter:return this.renderMmlDelimiter(e);case o.MmlRun:return this.renderMmlRun(e);case o.MmlNary:return this.renderMmlNary(e);case o.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case o.MmlBar:return this.renderMmlBar(e);case o.MmlEquationArray:return this.renderMllList(e);case o.Inserted:return this.renderInserted(e);case o.Deleted:return this.renderDeleted(e)}return null}renderChildren(e,t){return this.renderElements(e.children,t)}renderElements(e,t){if(e==null)return null;var r=e.flatMap(a=>this.renderElement(a)).filter(a=>a!=null);return t&&z(t,r),r}renderContainer(e,t,r){return this.createElement(t,r,this.renderChildren(e))}renderContainerNS(e,t,r,a){return m(t,r,a,this.renderChildren(e))}renderParagraph(e){var t,r,a,n,i=this.createElement("p");const c=this.findStyle(e.styleName);(a=e.tabs)!==null&&a!==void 0||(e.tabs=(t=c==null?void 0:c.paragraphProps)==null?void 0:t.tabs),this.renderClass(e,i),this.renderChildren(e,i),this.renderStyleValues(e.cssStyle,i),this.renderCommonProperties(i.style,e);const u=(n=e.numbering)!==null&&n!==void 0?n:(r=c==null?void 0:c.paragraphProps)==null?void 0:r.numbering;return u&&i.classList.add(this.numberingClass(u.id,u.level)),i}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){t!=null&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderHyperlink(e){var t=this.createElement("a");if(this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.href)t.href=e.href;else if(e.id){const r=this.document.documentPart.rels.find(a=>a.id==e.id&&a.targetMode==="External");t.href=r==null?void 0:r.target}return t}renderDrawing(e){var t=this.createElement("div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=this.createElement("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(r=>{t.src=r})),t}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderEndnotes?this.htmlDocument.createTextNode(e.text):null}renderBreak(e){return e.break=="textWrapping"?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderChildren(e)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderTab(e){var t,r=this.createElement("span");if(r.innerHTML="&emsp;",this.options.experimental){r.className=this.tabStopClass();var a=(t=Rt(e,o.Paragraph))==null?void 0:t.tabs;this.currentTabs.push({stops:a,span:r})}return r}renderBookmarkStart(e){var t=this.createElement("span");return t.id=e.name,t}renderRun(e){if(e.fieldRun)return null;const t=this.createElement("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){const r=this.createElement(e.verticalAlign);this.renderChildren(e,r),t.appendChild(r)}else this.renderChildren(e,t);return t}renderTable(e){let t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=this.createElement("colgroup");for(let r of e){let a=this.createElement("col");r.width&&(a.style.width=r.width),t.appendChild(a)}return t}renderTableRow(e){let t=this.createElement("tr");return this.currentCellPosition.col=0,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentCellPosition.row++,t}renderTableCell(e){let t=this.createElement("td");const r=this.currentCellPosition.col;return e.verticalMerge?e.verticalMerge=="restart"?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){var t=V("div");return this.renderChildren(e,t),t}renderVmlElement(e){var t,r,a=re("svg");a.setAttribute("style",e.cssStyleText);const n=this.renderVmlChildElement(e);return(t=e.imageHref)!=null&&t.id&&this.tasks.push((r=this.document)==null?void 0:r.loadDocumentImage(e.imageHref.id,this.currentPart).then(i=>n.setAttribute("href",i))),a.appendChild(n),requestAnimationFrame(()=>{const i=a.firstElementChild.getBBox();a.setAttribute("width",`${Math.ceil(i.x+i.width)}`),a.setAttribute("height",`${Math.ceil(i.y+i.height)}`)}),a}renderVmlChildElement(e){const t=re(e.tagName);Object.entries(e.attrs).forEach(([r,a])=>t.setAttribute(r,a));for(let r of e.children)r.type==o.VmlElement?t.appendChild(this.renderVmlChildElement(r)):t.appendChild(...x(this.renderElement(r)));return t}renderMmlRadical(e){var t;const r=e.children.find(n=>n.type==o.MmlBase);if((t=e.props)!=null&&t.hideDegree)return m(p.mathML,"msqrt",null,this.renderElements([r]));const a=e.children.find(n=>n.type==o.MmlDegree);return m(p.mathML,"mroot",null,this.renderElements([r,a]))}renderMmlDelimiter(e){var t,r;const a=[];return a.push(m(p.mathML,"mo",null,[(t=e.props.beginChar)!==null&&t!==void 0?t:"("])),a.push(...this.renderElements(e.children)),a.push(m(p.mathML,"mo",null,[(r=e.props.endChar)!==null&&r!==void 0?r:")"])),m(p.mathML,"mrow",null,a)}renderMmlNary(e){var t,r;const a=[],n=A(e.children,b=>b.type),i=n[o.MmlSuperArgument],c=n[o.MmlSubArgument],u=i?m(p.mathML,"mo",null,x(this.renderElement(i))):null,h=c?m(p.mathML,"mo",null,x(this.renderElement(c))):null,d=m(p.mathML,"mo",null,[(r=(t=e.props)==null?void 0:t.char)!==null&&r!==void 0?r:"∫"]);return u||h?a.push(m(p.mathML,"munderover",null,[d,h,u])):u?a.push(m(p.mathML,"mover",null,[d,u])):h?a.push(m(p.mathML,"munder",null,[d,h])):a.push(d),a.push(...this.renderElements(n[o.MmlBase].children)),m(p.mathML,"mrow",null,a)}renderMmlPreSubSuper(e){const t=[],r=A(e.children,h=>h.type),a=r[o.MmlSuperArgument],n=r[o.MmlSubArgument],i=a?m(p.mathML,"mo",null,x(this.renderElement(a))):null,c=n?m(p.mathML,"mo",null,x(this.renderElement(n))):null,u=m(p.mathML,"mo",null);return t.push(m(p.mathML,"msubsup",null,[u,c,i])),t.push(...this.renderElements(r[o.MmlBase].children)),m(p.mathML,"mrow",null,t)}renderMmlGroupChar(e){const t=e.props.verticalJustification==="bot"?"mover":"munder",r=this.renderContainerNS(e,p.mathML,t);return e.props.char&&r.appendChild(m(p.mathML,"mo",null,[e.props.char])),r}renderMmlBar(e){const t=this.renderContainerNS(e,p.mathML,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline";break}return t}renderMmlRun(e){const t=m(p.mathML,"ms");return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderChildren(e,t),t}renderMllList(e){const t=m(p.mathML,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderChildren(e);for(let r of this.renderChildren(e))t.appendChild(m(p.mathML,"mtr",null,[m(p.mathML,"mtd",null,[r])]));return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){var t;return e&&((t=this.styleMap)==null?void 0:t[e])}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(e,t,r=null){let a=`${e} {\r
`;for(const n in t)n.startsWith("$")||(a+=`  ${n}: ${t[n]};\r
`);return r&&(a+=r),a+`}\r
`}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){var n;const i={tab:"\\9",space:"\\a0"};var c=e.replace(/%\d*/g,u=>{let h=parseInt(u.substring(1),10)-1;return`"counter(${this.numberingCounter(r,h)}, ${a})"`});return`"${c}${(n=i[t])!==null&&n!==void 0?n:""}"`}numFormatToCssValue(e){var t,r={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"};return(t=r[e])!==null&&t!==void 0?t:e}refreshTabStops(){this.options.experimental&&(clearTimeout(this.tabsTimeout),this.tabsTimeout=setTimeout(()=>{const e=xt();for(let t of this.currentTabs)Ft(t.span,t.stops,this.defaultTabSize,e)},500))}}function V(s,e,t){return m(void 0,s,e,t)}function re(s,e,t){return m(p.svg,s,e,t)}function m(s,e,t,r){var a=s?document.createElementNS(s,e):document.createElement(e);return Object.assign(a,t),r&&z(a,r),a}function ae(s){s.innerHTML=""}function z(s,e){e.forEach(t=>s.appendChild(Te(t)?document.createTextNode(t):t))}function E(s){return V("style",{innerHTML:s})}function B(s,e){s.appendChild(document.createComment(e))}function Rt(s,e){for(var t=s.parent;t!=null&&t.type!=e;)t=t.parent;return t}const ge={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1};function Lt(s,e){const t={...ge,...e};return U.load(s,new Nt(t),t)}async function Tt(s,e,t,r){const a={...ge,...r},n=new Bt(window.document);return n.render(s,e,t,a),Promise.allSettled(n.tasks.filter(i=>i))}async function se(s,e,t,r){const a=await Lt(s,r);return await Tt(a,e,t,r),a}const Dt=async s=>{if(typeof document<"u"){const{bodyContainer:e,styleContainer:t,buffer:r,docxOptions:a={}}=s,i=Object.assign({},{className:"docx"},a);if(e)return se(r,e,t,i);{const c=document.createElement("div");return document.body.appendChild(c),se(r,c,t,i)}}};export{Dt as renderDocx};
